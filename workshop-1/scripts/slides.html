<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Shao-Ching Huang" />
  <meta name="dcterms.date" content="2025-10-09" />
  <title>Foundations for Sustainable Research Software</title>
  <style>
    /* Default styles provided by pandoc.
    ** See https://pandoc.org/MANUAL.html#variables-for-html for config info.
    */
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="custom.css" />
</head>
<body>
<header id="title-block-header">
<h1 class="title"><strong>Foundations for Sustainable Research
Software</strong></h1>
<p class="author">Shao-Ching Huang</p>
<p class="date">2025-10-09</p>
</header>
<p>Workshop series:</p>
<ol type="1">
<li><p>Foundations for sustainable research software (October
9)</p></li>
<li><p>Scaling your science with parallel computing (October
16)</p></li>
<li><p>Accelerating your code with GPUs (October 30)</p></li>
</ol>
<p>Resources:</p>
<ul>
<li><p>Workshop materials <a
href="https://github.com/schuang/advanced-python-series">[link]</a></p></li>
<li><p>UCLA Office of Advanced Research Computing <a
href="https://oarc.ucla.edu/contact">[link]</a></p></li>
<li><p>Hoffman2 Cluster <a
href="https://www.hoffman2.idre.ucla.edu">[link]</a></p></li>
</ul>
<h1 id="introduction">Introduction</h1>
<h2 id="observation">Observation</h2>
<ul>
<li><p>Python has become a dominant language for scientific computing
and machine learning</p></li>
<li><p>Widespread use of Notebooks has led to proliferation of “linear”
scripts that are difficult to reuse</p></li>
<li><p>Advanced Python features for software reuse remain underutilized
in research code</p></li>
<li><p>Many Python codebases are limited to single-core
execution</p></li>
<li><p>Multi-core CPUs are standard, and GPU resources are increasingly
accessible</p></li>
</ul>
<h2 id="software-sustainability">Software Sustainability</h2>
<ul>
<li><p>Keeps research code usable and maintainable over time</p></li>
<li><p>Facilitates collaboration and sharing across research
teams</p></li>
<li><p>Prevents code from becoming obsolete or unusable</p></li>
<li><p>Enables efficient updates, bug fixes, and feature
enhancements</p></li>
<li><p>Ensures reproducibility and transparency in scientific
workflows</p></li>
<li><p>Distinguishes sustainable software from disposable one-time
scripts</p></li>
</ul>
<h2 id="general-goals-of-this-workshop-series">General Goals of This
Workshop Series</h2>
<ul>
<li><p>Transform ad-hoc scripts into well-structured, reusable
software</p></li>
<li><p>Teach best practices for writing maintainable research
code</p></li>
<li><p>Demonstrate how to package and distribute code
effectively</p></li>
<li><p>Emphasize reproducibility in computational workflows</p></li>
<li><p>Provide hands-on examples for scientific computing
applications</p></li>
<li><p>Leverage modern hardware: multi-core CPUs and GPUs</p></li>
<li><p>Empower researchers to build robust, sustainable
software</p></li>
</ul>
<h2 id="why-learn-this-in-the-llm-era">Why Learn This in the LLM
Era?</h2>
<p>Even with powerful LLM-based code-generating assistants,
understanding software design principles remains critical:</p>
<ul>
<li><p>You provide the human intelligence</p>
<ul>
<li><p>LLMs need clear, structured prompts that reflect good design
thinking</p></li>
<li><p>You must specify what architecture, patterns, and structure you
want</p></li>
<li><p>Without understanding concepts like classes, inheritance, or
packaging, you can’t guide the LLM effectively</p></li>
</ul></li>
<li><p>You must read and validate generated code</p>
<ul>
<li><p>LLMs make mistakes, introduce bugs, and sometimes generate
outdated or inefficient patterns</p></li>
<li><p>You need to recognize when code follows best practices
vs. anti-patterns</p></li>
</ul></li>
<li><p>You maintain and evolve the codebase</p>
<ul>
<li><p>Generated code needs to be integrated, refactored, and maintained
over time</p></li>
<li><p>You make architectural decisions that LLMs cannot: “Should this
be a class or a function?” “How should components interact?”</p></li>
<li><p>Long-term project success depends on human oversight of structure
and design</p></li>
</ul></li>
</ul>
<h2 id="transitioning-from-scripts-to-software">Transitioning from
Scripts to Software</h2>
<p>A Staged Approach (using Python as an example)</p>
<ul>
<li><p><strong>Refactor linear scripts into functions</strong></p>
<ul>
<li><p>Each function does one thing (single responsibility
principle)</p></li>
<li><p>Use descriptive, meaningful function names</p></li>
<li><p>Add clear comments and documentation</p></li>
</ul></li>
<li><p><strong>Group related functions into classes</strong></p></li>
<li><p><strong>Organize code into modules</strong> by topic or
workflow</p></li>
<li><p><strong>Practice is essential</strong> — mastering this skill
takes time</p></li>
</ul>
<p>Bottom line: for sustainable code, organize logic into functions
rather than linear scripts.</p>
<h1 id="python-functions">Python Functions</h1>
<ul>
<li><p>Functions organize code into reusable, testable blocks</p></li>
<li><p>Eliminate repetition and simplify debugging and
maintenance</p></li>
<li><p>Encapsulate local variables within function scope</p></li>
</ul>
<p>We will explore several essential features of Python functions.</p>
<hr />
<h2 id="type-hinting">Type Hinting</h2>
<p>Improves code readability and helps with static analysis tools.</p>
<p>Introduced in Python 3.5 (PEP 484) in 2015.</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>count: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>name: <span class="bu">str</span> <span class="op">=</span> <span class="st">&quot;Alice&quot;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>data: <span class="bu">list</span>[<span class="bu">float</span>] <span class="op">=</span> [<span class="fl">1.0</span>, <span class="fl">2.5</span>, <span class="fl">3.7</span>]</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Any</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>mixed: <span class="bu">list</span>[Any] <span class="op">=</span> [<span class="dv">1</span>, <span class="st">&quot;two&quot;</span>, <span class="fl">3.0</span>, [<span class="dv">4</span>, <span class="dv">5</span>]]</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> add(x: <span class="bu">int</span>, y: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> x <span class="op">+</span> y</span></code></pre></div>
<h4 id="pros-and-cons-of-type-hints">Pros and Cons of Type Hints</h4>
<p><strong>Pros:</strong></p>
<ul>
<li><p>Improve readability and documentation</p></li>
<li><p>Catch bugs early with static analysis</p></li>
<li><p>Enable better IDE support (auto-completion, type
checking)</p></li>
<li><p>Facilitate refactoring in large projects</p></li>
</ul>
<p><strong>Cons:</strong></p>
<ul>
<li><p>Increase code verbosity</p></li>
<li><p>Not enforced at runtime (without extra tools)</p></li>
<li><p>Require extra effort for complex types</p></li>
<li><p>Third-party libraries may lack type stubs</p></li>
</ul>
<p><strong>Note:</strong> Type hints do not affect compiled Python code
in libraries like Numba or JAX. These libraries ignore Python type hints
and use their own mechanisms (such as decorators or explicit type
annotations) for optimization and compilation. Type hints are mainly for
static analysis, documentation, and editor support—not for runtime or
compilation behavior in Numba/JAX.</p>
<h3 id="type-hint-examples-with-numpy">Type Hint Examples with
NumPy</h3>
<div class="sourceCode" id="cb2"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Tuple, Optional</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate mean of a 1D array</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mean(arr: np.ndarray) <span class="op">-&gt;</span> <span class="bu">float</span>:</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="bu">float</span>(np.mean(arr))</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalize a vector</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize(vec: np.ndarray) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> vec <span class="op">/</span> np.linalg.norm(vec)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute dot product of two arrays</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dot(a: np.ndarray, b: np.ndarray) <span class="op">-&gt;</span> <span class="bu">float</span>:</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="bu">float</span>(np.dot(a, b))</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Return shape and dtype of an array</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> array_info(arr: np.ndarray) <span class="op">-&gt;</span> Tuple[Tuple[<span class="bu">int</span>, ...], <span class="bu">str</span>]:</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> arr.shape, <span class="bu">str</span>(arr.dtype)</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Optional return type: can return None if input is empty</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> safe_mean(arr: np.ndarray) <span class="op">-&gt;</span> Optional[<span class="bu">float</span>]:</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> arr.size <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="bu">float</span>(np.mean(arr))</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Function accepting and returning 2D arrays</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> matrix_multiply(a: np.ndarray, b: np.ndarray) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> np.matmul(a, b)</span></code></pre></div>
<hr />
<h2 id="function-signature">Function signature</h2>
<p>A Python function is defined by its signature, which includes:</p>
<ul>
<li>The function name</li>
<li>The list of arguments (parameters)</li>
<li>The return type (optional, with type hints)</li>
</ul>
<h3 id="positional-arguments-vs-keyword-arguments">Positional Arguments
vs Keyword Arguments</h3>
<p><strong>Positional arguments</strong> are specified by their position
in the function call:</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> add(x, y):</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x <span class="op">+</span> y</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>add(<span class="dv">2</span>, <span class="dv">3</span>)  <span class="co"># x=2, y=3</span></span></code></pre></div>
<p><strong>Keyword arguments</strong> are specified by name:</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> greet(name, greeting<span class="op">=</span><span class="st">&quot;Hello&quot;</span>):</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="sc">{</span>greeting<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>name<span class="sc">}</span><span class="ss">!&quot;</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>greet(name<span class="op">=</span><span class="st">&quot;Alice&quot;</span>, greeting<span class="op">=</span><span class="st">&quot;Hi&quot;</span>)</span></code></pre></div>
<p>When calling a function, you can mix positional and keyword
arguments, but positional arguments must come first in the call.</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Valid</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>greet(<span class="st">&quot;Alice&quot;</span>, greeting<span class="op">=</span><span class="st">&quot;Hi&quot;</span>)  <span class="co"># positional, then keyword</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Invalid - causes SyntaxError</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>greet(name<span class="op">=</span><span class="st">&quot;Alice&quot;</span>, <span class="st">&quot;Hi&quot;</span>)      <span class="co"># keyword before positional</span></span></code></pre></div>
<h3 id="function-argument-types">Function Argument Types</h3>
<ul>
<li><p>Arguments can be any Python object: int, float, str, list, dict,
custom class, etc.</p></li>
<li><p>You can use type hints to specify expected types:</p></li>
</ul>
<div class="sourceCode" id="cb6"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> scale(x: <span class="bu">float</span>, factor: <span class="bu">float</span>) <span class="op">-&gt;</span> <span class="bu">float</span>:</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x <span class="op">*</span> factor</span></code></pre></div>
<h3 id="return-type">Return Type</h3>
<ul>
<li><p>Functions can return any Python object.</p></li>
<li><p>Use type hints to specify the return type:</p></li>
</ul>
<div class="sourceCode" id="cb7"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_name() <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">&quot;Alice&quot;</span></span></code></pre></div>
<hr />
<h2 id="passing-values-to-a-function">Passing values to a function</h2>
<ul>
<li><p>Python uses “pass by object reference” (sometimes called “pass by
assignment”).</p></li>
<li><p>Mutable objects (lists, dicts) can be changed inside
functions.</p></li>
<li><p>Immutable objects (ints, strings, tuples) cannot be changed
inside functions.</p></li>
<li><p>Example:</p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> modify_list(lst):</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    lst.append(<span class="dv">1</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>my_list <span class="op">=</span> []</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>modify_list(my_list)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(my_list)  <span class="co"># [1]</span></span></code></pre></div></li>
</ul>
<hr />
<h2 id="global-variables">Global Variables</h2>
<p>Avoid using <code>global</code> keyword unless absolutely
necessary.</p>
<ul>
<li><p>Global variables are accessible throughout the module and can
lead to bugs and hard-to-maintain code</p></li>
<li><p>Prefer passing variables as function arguments</p></li>
<li><p>Less modular, harder to test, and risk accidental
modification</p></li>
</ul>
<hr />
<h2 id="type-aliases-for-complex-types">Type Aliases for Complex
Types</h2>
<p>Type aliases make code easier to read and maintain, especially for
complex or repeated type hints.</p>
<p>Example:</p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Dict</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a type alias for a list of 2D coordinates</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>Coordinates <span class="op">=</span> List[Tuple[<span class="bu">float</span>, <span class="bu">float</span>]]</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the alias in a function signature</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> total_distance(points: Coordinates) <span class="op">-&gt;</span> <span class="bu">float</span>:</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ... implementation ...</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">pass</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Alias for a dictionary mapping strings to lists of integers</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>StrToIntList <span class="op">=</span> Dict[<span class="bu">str</span>, List[<span class="bu">int</span>]]</span></code></pre></div>
<p>Type aliases are especially useful in scientific code, where data
structures can be complex and reused across many functions.</p>
<hr />
<h2 id="exception-handling-within-functions">Exception handling within
functions</h2>
<p>Exception handling makes functions robust by catching and managing
errors gracefully.</p>
<p>Key behaviors:</p>
<ul>
<li><p>When an exception is raised, control immediately <strong>returns
to the caller</strong> (or nearest <code>except</code> block)</p></li>
<li><p>Remaining lines in the function are not executed</p></li>
<li><p>Unhandled exceptions abort the program and return control to the
operating system</p></li>
<li><p>Exception handling <strong>keeps programs running</strong>
instead of terminating unexpectedly</p></li>
</ul>
<p>Use <code>try</code>, <code>except</code>, and optionally
<code>finally</code> blocks:</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> safe_divide(x: <span class="bu">float</span>, y: <span class="bu">float</span>) <span class="op">-&gt;</span> <span class="bu">float</span>:</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">try</span>:</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x <span class="op">/</span> y</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">except</span> <span class="pp">ZeroDivisionError</span>:</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Error: Division by zero!&quot;</span>)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">float</span>(<span class="st">&#39;inf&#39;</span>)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> read_file(filename: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">try</span>:</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(filename) <span class="im">as</span> f:</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> f.read()</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">except</span> <span class="pp">FileNotFoundError</span>:</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;File not found: </span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">&quot;&quot;</span></span></code></pre></div>
<p>You can also raise exceptions to signal errors to the caller:</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_item(lst: <span class="bu">list</span>, idx: <span class="bu">int</span>):</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> idx <span class="op">&lt;</span> <span class="dv">0</span> <span class="kw">or</span> idx <span class="op">&gt;=</span> <span class="bu">len</span>(lst):</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">raise</span> <span class="pp">IndexError</span>(<span class="st">&quot;Index out of range&quot;</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> lst[idx]</span></code></pre></div>
<hr />
<h2 id="default-argument-values">Default argument values</h2>
<p>Default argument values allow parameters to have fallback values when
not provided by the caller. This makes functions more flexible and
easier to use.</p>
<p>Example:</p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> greet(name, greeting<span class="op">=</span><span class="st">&quot;Hello&quot;</span>):</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="sc">{</span>greeting<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>name<span class="sc">}</span><span class="ss">!&quot;</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>greet(<span class="st">&quot;Alice&quot;</span>)           <span class="co"># Output: Hello, Alice!</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>greet(<span class="st">&quot;Bob&quot;</span>, greeting<span class="op">=</span><span class="st">&quot;Hi&quot;</span>)  <span class="co"># Output: Hi, Bob!</span></span></code></pre></div>
<p>Required parameters must come before parameters with default values
in the function definition.</p>
<div class="sourceCode" id="cb13"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Valid</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> greet(name, greeting<span class="op">=</span><span class="st">&quot;Hello&quot;</span>):  <span class="co"># required first, then default</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">pass</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Invalid - SyntaxError</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> greet(greeting<span class="op">=</span><span class="st">&quot;Hello&quot;</span>, name):  <span class="co"># default before required</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">pass</span></span></code></pre></div>
<hr />
<h2 id="keyword-only-arguments">Keyword-only arguments</h2>
<p>Keyword-only arguments must be specified by name when calling the
function. Define them by placing a <code>*</code> in the function
signature before those parameters.</p>
<p>Examples:</p>
<div class="sourceCode" id="cb14"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> example(a, b, <span class="op">*</span>, c, d<span class="op">=</span><span class="dv">5</span>):</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(a, b, c, d)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>example(<span class="dv">1</span>, <span class="dv">2</span>, c<span class="op">=</span><span class="dv">3</span>)      <span class="co"># c must be specified as a keyword</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>example(<span class="dv">1</span>, <span class="dv">2</span>, d<span class="op">=</span><span class="dv">7</span>, c<span class="op">=</span><span class="dv">4</span>) <span class="co"># both c and d must be specified as keywords</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> greet(name, <span class="op">*</span>, greeting):  <span class="co"># greeting is keyword-only</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="sc">{</span>greeting<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>name<span class="sc">}</span><span class="ss">!&quot;</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>greet(<span class="st">&quot;Alice&quot;</span>, <span class="st">&quot;Hello&quot;</span>)           <span class="co"># ERROR! Can&#39;t pass greeting positionally</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>greet(<span class="st">&quot;Alice&quot;</span>, greeting<span class="op">=</span><span class="st">&quot;Hello&quot;</span>)  <span class="co"># Required - must use keyword</span></span></code></pre></div>
<p>Benefits: improves code clarity and prevents argument order mistakes.
All parameters after <code>*</code> must be given as keywords.</p>
<hr />
<h2 id="args-and-kwargs">*args and **kwargs</h2>
<ul>
<li><p><code>*args</code>: allows a function to accept any number of
positional arguments (as a tuple).</p></li>
<li><p><code>**kwargs</code>: allows a function to accept any number of
keyword arguments (as a dict).</p></li>
</ul>
<p>Example:</p>
<div class="sourceCode" id="cb16"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> demo(<span class="op">*</span>args, <span class="op">**</span>kwargs):</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(args)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(kwargs)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>demo(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, a<span class="op">=</span><span class="dv">4</span>, b<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Output: (1, 2, 3) {&#39;a&#39;: 4, &#39;b&#39;: 5}</span></span></code></pre></div>
<hr />
<h2 id="context-managers-with-statement-custom-via-enterexit">Context
managers (with statement, custom via
<strong>enter</strong>/<strong>exit</strong>)</h2>
<p>Context managers are a Python feature that help you manage resources
(like files, network connections, or locks) safely and automatically.
They ensure setup and cleanup code runs reliably, even if errors
occur.</p>
<p>The most common way to use a context manager is with the
<code>with</code> statement.</p>
<h3 id="file-handling">File Handling</h3>
<p>You will never forget to “close” a file:</p>
<div class="sourceCode" id="cb17"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">&quot;data.txt&quot;</span>) <span class="im">as</span> f:</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  data <span class="op">=</span> f.read()</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># File is automatically closed when the block ends</span></span></code></pre></div>
<h3 id="connecting-to-a-database">Connecting to a database</h3>
<div class="sourceCode" id="cb18"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sqlite3</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Using the built-in context manager for sqlite3</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> sqlite3.<span class="ex">connect</span>(<span class="st">&quot;example.db&quot;</span>) <span class="im">as</span> conn:</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    cursor <span class="op">=</span> conn.cursor()</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    cursor.execute(<span class="st">&quot;CREATE TABLE IF NOT EXISTS users (id INTEGER, name TEXT)&quot;</span>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    cursor.execute(<span class="st">&quot;INSERT INTO users VALUES (?, ?)&quot;</span>, (<span class="dv">1</span>, <span class="st">&quot;Alice&quot;</span>))</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    conn.commit()</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    cursor.execute(<span class="st">&quot;SELECT * FROM users&quot;</span>)</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(cursor.fetchall())</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Connection is automatically closed when the block ends</span></span></code></pre></div>
<h3 id="custom-context-manager">Custom Context Manager</h3>
<p>You can create your own context managers by defining
<code>__enter__</code> and <code>__exit__</code> methods:</p>
<div class="sourceCode" id="cb19"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Timer:</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__enter__</span>(<span class="va">self</span>):</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>        <span class="im">import</span> time</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.start <span class="op">=</span> time.time()</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;Timer started&quot;</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__exit__</span>(<span class="va">self</span>, exc_type, exc_val, exc_tb):</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>        <span class="im">import</span> time</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>        elapsed <span class="op">=</span> time.time() <span class="op">-</span> <span class="va">self</span>.start</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;Timer stopped. Elapsed time: </span><span class="sc">{</span>elapsed<span class="sc">:.2f}</span><span class="ss">s&quot;</span>)</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span>  <span class="co"># Don&#39;t suppress exceptions</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Usage</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> Timer():</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Do some work</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>    <span class="bu">sum</span>([i<span class="op">**</span><span class="dv">2</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1000000</span>)])</span></code></pre></div>
<ul>
<li><p>The <code>__enter__</code> method runs when entering the
<code>with</code> block and can return a value.</p></li>
<li><p>The <code>__exit__</code> method runs when exiting the block
(even if an error occurs) and receives exception information if an error
happened.</p></li>
</ul>
<hr />
<h2 id="function-decorators">Function Decorators</h2>
<ul>
<li><p>Decorators are functions that modify the behavior of other
functions.</p></li>
<li><p>Common uses: logging, timing, access control.</p></li>
</ul>
<h3 id="example">Example</h3>
<div class="sourceCode" id="cb20"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> my_decorator(func):</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> wrapper(<span class="op">*</span>args, <span class="op">**</span>kwargs):</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;Before function call&quot;</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> func(<span class="op">*</span>args, <span class="op">**</span>kwargs)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;After function call&quot;</span>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> result</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> wrapper</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="at">@my_decorator</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> greet(name):</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Hello, </span><span class="sc">{</span>name<span class="sc">}</span><span class="ss">!&quot;</span>)</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>greet(<span class="st">&quot;Alice&quot;</span>)</span></code></pre></div>
<h3 id="example-1">Example</h3>
<div class="sourceCode" id="cb21"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> timing_decorator(func):</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> wrapper(<span class="op">*</span>args, <span class="op">**</span>kwargs):</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    start <span class="op">=</span> time.time()</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> func(<span class="op">*</span>args, <span class="op">**</span>kwargs)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    end <span class="op">=</span> time.time()</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="sc">{</span>func<span class="sc">.</span><span class="va">__name__</span><span class="sc">}</span><span class="ss"> took </span><span class="sc">{</span>end <span class="op">-</span> start<span class="sc">:.4f}</span><span class="ss"> seconds&quot;</span>)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> wrapper</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="at">@timing_decorator</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> slow_function():</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>  time.sleep(<span class="dv">1</span>)</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">&quot;Done!&quot;</span>)</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>slow_function()</span></code></pre></div>
<hr />
<h2 id="calling-functions-from-other-files">Calling Functions from Other
Files</h2>
<ul>
<li>Use <code>import</code> to access functions defined in other Python
files (modules).</li>
</ul>
<p>In <code>utils.py</code>:</p>
<div class="sourceCode" id="cb22"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> helper():</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Helping!&quot;</span>)</span></code></pre></div>
<p>In another file:</p>
<div class="sourceCode" id="cb23"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> utils <span class="im">import</span> helper</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>helper()</span></code></pre></div>
<h1 id="python-classes">Python Classes</h1>
<h2 id="the-problem-with-scripts">The Problem with Scripts</h2>
<p>As researchers, we often start with a script:</p>
<ul>
<li>Load data</li>
<li>Define variables for parameters</li>
<li>Run functions to get results</li>
</ul>
<p>This works, but has serious limitations:</p>
<ul>
<li>Data and parameters “float” around without structure</li>
<li>Easy to accidentally use wrong variables</li>
<li>Simple to corrupt data in ways that break later steps</li>
</ul>
<p>Imagine a script to analyze a simulation trajectory. You might
have:</p>
<div class="sourceCode" id="cb24"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A collection of disconnected variables</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>trajectory_file <span class="op">=</span> <span class="st">&#39;sim_run_01.xtc&#39;</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>topology_file <span class="op">=</span> <span class="st">&#39;system.pdb&#39;</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>temperature <span class="op">=</span> <span class="fl">300.0</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>pressure <span class="op">=</span> <span class="fl">1.0</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> <span class="va">None</span> <span class="co"># Will be populated later</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> load_data(traj, top):</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ... loads data ...</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> loaded_data</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_rmsd(data, temp):</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ... does a calculation ...</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> rmsd_values</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a><span class="co"># The script runs top-to-bottom</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>sim_data <span class="op">=</span> load_data(trajectory_file, topology_file)</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> calculate_rmsd(sim_data, temperature)</span></code></pre></div>
<p>This is hard to reproduce. What if you forget to pass
<code>temperature</code> to the <code>calculate_rmsd</code> function?
What if another part of the script accidentally changes the value of
<code>sim_data</code>? The state of your analysis is fragile and spread
out.</p>
<hr />
<h3 id="an-alternative-the-composite-function">An Alternative: The
“Composite Function”</h3>
<p>A common instinct for organizing this workflow without classes is to
create a single “master” function that calls the other functions in
sequence.</p>
<div class="sourceCode" id="cb25"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> run_full_analysis(trajectory_file, topology_file, temperature, pressure):</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Runs the entire analysis pipeline.&quot;&quot;&quot;</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    sim_data <span class="op">=</span> load_data(trajectory_file, topology_file)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> calculate_rmsd(sim_data, temperature)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ... maybe a dozen more steps ...</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> results</span></code></pre></div>
<p>This is certainly an improvement over a loose script, but it has a
critical weakness that highlights the true value of classes.</p>
<h3 id="the-problem-with-the-composite-function-opaque-state">The
Problem with the Composite Function: Opaque State</h3>
<p>The composite function is a <strong>black box</strong>. You put
parameters in, and you get a final result out. But what if you want to
inspect the intermediate steps? * How do you access the
<code>sim_data</code> after it’s been loaded? * What if you want to run
an additional, exploratory analysis on the loaded data without
re-running the whole pipeline? * What if you want to change a parameter
and only re-run the last step?</p>
<p>With a composite function, you can’t. The intermediate data
(<code>sim_data</code>) is created and then immediately thrown away
inside the function’s local scope. The entire state of the analysis is
temporary and inaccessible.</p>
<hr />
<h2 id="the-solution-a-self-contained-simulation-class">The Solution: A
Self-Contained <code>Simulation</code> Class</h2>
<p>A class lets us bundle all of this into a single, coherent unit.</p>
<div class="sourceCode" id="cb26"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> SimulationAnalysis:</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;A class to hold and analyze a single simulation run.&quot;&quot;&quot;</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, trajectory_file, topology_file, temperature, pressure):</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;The constructor: sets up the object&#39;s initial state.&quot;&quot;&quot;</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>        <span class="co"># --- Attributes: The data of the object ---</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.trajectory_file <span class="op">=</span> trajectory_file</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.topology_file <span class="op">=</span> topology_file</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.temperature <span class="op">=</span> temperature</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.pressure <span class="op">=</span> pressure</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Internal state, starts empty</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.data <span class="op">=</span> <span class="va">None</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.rmsd_results <span class="op">=</span> <span class="va">None</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> load_data(<span class="va">self</span>):</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;A method that operates on the object&#39;s own data.&quot;&quot;&quot;</span></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;Loading data from </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>trajectory_file<span class="sc">}</span><span class="ss">...&quot;</span>)</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># In a real scenario, this would use a library like MDAnalysis or mdtraj</span></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>        <span class="co"># self.data = ... load from self.trajectory_file ...</span></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.data <span class="op">=</span> np.random.rand(<span class="dv">100</span>, <span class="dv">3</span>) <span class="co"># Placeholder for real data</span></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> calculate_rmsd(<span class="va">self</span>):</span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Another method. It uses the object&#39;s internal state.&quot;&quot;&quot;</span></span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.data <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">&quot;Data not loaded. Please run .load_data() first.&quot;</span>)</span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Notice how it uses its own attributes, like self.temperature</span></span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;Calculating RMSD at </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>temperature<span class="sc">}</span><span class="ss"> K...&quot;</span>)</span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a>        <span class="co"># self.rmsd_results = ... perform calculation on self.data ...</span></span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.rmsd_results <span class="op">=</span> np.mean(<span class="va">self</span>.data, axis<span class="op">=</span><span class="dv">1</span>) <span class="co"># Placeholder calculation</span></span></code></pre></div>
<h3 id="using-the-class">Using the Class</h3>
<p>Now, our analysis is an “object.” All the data and logic are neatly
packaged together.</p>
<div class="sourceCode" id="cb27"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an instance of our analysis for a specific run</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>sim_run_1 <span class="op">=</span> SimulationAnalysis(</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    trajectory_file<span class="op">=</span><span class="st">&#39;sim_run_01.xtc&#39;</span>,</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    topology_file<span class="op">=</span><span class="st">&#39;system.pdb&#39;</span>,</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    temperature<span class="op">=</span><span class="fl">300.0</span>,</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    pressure<span class="op">=</span><span class="fl">1.0</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Call the methods in a logical order</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>sim_run_1.load_data()</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>sim_run_1.calculate_rmsd()</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a><span class="co"># The results are stored safely inside the object</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;First 5 RMSD values: </span><span class="sc">{</span>sim_run_1<span class="sc">.</span>rmsd_results[:<span class="dv">5</span>]<span class="sc">}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<h2 id="why-classes-are-critical-for-reproducible-science">Why Classes
Are Critical for Reproducible Science</h2>
<p>Funding agencies, publishers, and the scientific community
increasingly demand reproducible computational research. This means code
must be clear, robust, and easy for others to run and understand.</p>
<p>Classes achieve this in ways that are difficult without them:</p>
<ol type="1">
<li>Encapsulation for Integrity
<ul>
<li>Bundles data and methods together</li>
<li>Protects analysis integrity</li>
<li>Results stored safely inside objects</li>
<li>Harder to accidentally modify</li>
<li>Object acts as a “snapshot” of specific analysis</li>
</ul></li>
<li>Clarity and Reusability
<ul>
<li>Makes workflow explicit</li>
<li>Easy to create independent analysis objects</li>
<li>Multiple datasets without interference</li>
</ul>
<div class="sourceCode" id="cb28"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>sim_run_2 <span class="op">=</span> SimulationAnalysis(<span class="st">&#39;sim_run_02.xtc&#39;</span>, <span class="st">&#39;system.pdb&#39;</span>, <span class="fl">310.0</span>, <span class="fl">1.0</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>sim_run_2.load_data()</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>sim_run_2.calculate_rmsd()</span></code></pre></div>
<ul>
<li>Nearly impossible to manage safely with floating variables</li>
</ul></li>
<li>A Contract for Your Science
<ul>
<li><code>__init__</code> defines required parameters</li>
<li>Methods define operation sequence</li>
<li>Easier for colleagues and reviewers to verify methodology</li>
</ul></li>
<li>Enabling Safe Refactoring
<ul>
<li>Refactoring: restructure code to improve design without changing
behavior</li>
<li>Like revising a manuscript: improve flow and clarity, not
content</li>
<li>Tangled scripts are terrifying to change</li>
<li>Classes make refactoring safe through encapsulation</li>
<li>Change internal implementation without breaking other code</li>
<li>Essential for long-term research projects</li>
</ul></li>
</ol>
<h3 id="beyond-code-reproducing-the-computing-environment">Beyond Code:
Reproducing the Computing Environment</h3>
<p>True reproducibility requires more than well-structured code. The
classic “it works on my computer” syndrome occurs when environments
differ.</p>
<p>The environment must be captured and shared at multiple levels:</p>
<ul>
<li>Python Dependencies
<ul>
<li>Recreate exact package versions</li>
<li>Tools: <code>pip</code> with <code>requirements.txt</code>,
<code>conda</code>, or <code>uv</code></li>
</ul></li>
<li>System-Level Dependencies
<ul>
<li>C libraries or system tools</li>
<li>Tools: <code>conda</code> for non-Python software</li>
</ul></li>
<li>Entire Operating System
<ul>
<li>Highest level of reproducibility</li>
<li>Tools: containers (Docker, Apptainer)</li>
<li>Package code, dependencies, and OS into portable image</li>
</ul></li>
</ul>
<p>Two critical steps for reproducibility: 1. Use classes to organize
scientific logic 2. Place code into well-defined, reproducible
environment</p>
<p>Bottom line: Without classes, you present a script and loose
variables, asking others to trust correct usage. With classes, you
present a self-contained, verifiable scientific instrument.</p>
<h1 id="python-classes-syntax-and-grammar">Python Classes: Syntax and
Grammar</h1>
<p>This guide covers fundamental syntax for creating and using classes
in Python.</p>
<h2 id="the-core-concept-blueprints-and-instances">The Core Concept:
Blueprints and Instances</h2>
<p>Two core concepts:</p>
<ul>
<li>Class: a blueprint defining structure and behavior
<ul>
<li>Example: <code>Molecule</code> class defines that all molecules have
<code>name</code> and <code>coordinates</code></li>
</ul></li>
<li>Object: a specific instance created from the blueprint
<ul>
<li>Example: <code>water</code> and <code>caffeine</code> objects
created from <code>Molecule</code> class</li>
<li>Each holds its own unique data</li>
</ul></li>
</ul>
<h3 id="why-use-classes">Why use classes?</h3>
<p>Scripts with loose variables are error-prone. Classes provide:</p>
<ul>
<li>Single, coherent object (e.g., <code>water</code>) that knows its
own data</li>
<li>Call methods on the object (e.g.,
<code>water.calculate_center_of_mass()</code>)</li>
<li>Bundle data and behavior together</li>
<li>Safer, more organized, easier to debug and share</li>
</ul>
<h2 id="the-basic-structure-class-and-__init__">The Basic Structure:
<code>class</code> and <code>__init__</code></h2>
<p>Basic components:</p>
<ul>
<li><code>class</code> keyword followed by class name</li>
<li>Methods: functions that belong to a class</li>
<li><code>__init__</code>: the constructor
<ul>
<li>Called automatically when creating new instance</li>
<li>Sets up initial state by creating attributes</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb29"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Molecule:</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># __init__ is the constructor method.</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># It runs when you create a new Molecule object.</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, name, charge, coordinates):</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;Creating a new Molecule object for </span><span class="sc">{</span>name<span class="sc">}</span><span class="ss">...&quot;</span>)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># --- Attributes ---</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>        <span class="co"># These are variables that belong to the object.</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>        <span class="co"># They are created by assigning to `self`.</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.name <span class="op">=</span> name</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.charge <span class="op">=</span> charge</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.coordinates <span class="op">=</span> coordinates</span></code></pre></div>
<h2 id="the-self-keyword-the-most-important-concept">The
<code>self</code> Keyword: The Most Important Concept</h2>
<p><code>self</code> is the first argument of any instance method.</p>
<p>Key points:</p>
<ul>
<li>Refers to the specific object (instance) the method is called
on</li>
<li>When you write <code>my_molecule.some_method()</code>, Python
automatically passes <code>my_molecule</code> as <code>self</code></li>
</ul>
<p>Why is <code>self</code> needed?</p>
<ul>
<li>Methods are defined once on the class (blueprint)</li>
<li>Multiple objects can exist (<code>water</code>,
<code>caffeine</code>)</li>
<li>When calling <code>water.calculate_center_of_mass()</code>, Python
needs to know which object’s data to use</li>
<li><code>self</code> makes that connection</li>
</ul>
<p>Usage:</p>
<ul>
<li>Access object’s own attributes and methods inside the method</li>
<li>Example: <code>self.name = name</code> stores input
<code>name</code> in this specific object’s attribute</li>
</ul>
<h2 id="building-a-class-a-step-by-step-example">Building a Class: A
Step-by-Step Example</h2>
<p>To understand the syntax, we will build up a single, coherent
<code>Molecule</code> class from scratch.</p>
<h3 id="the-__init__-method-and-instance-attributes">1. The
<code>__init__</code> Method and Instance Attributes</h3>
<p>Goal: Create <code>Molecule</code> objects with unique
<code>name</code>, <code>formula</code>, and
<code>coordinates</code>.</p>
<ul>
<li>Instance attributes: unique to each object</li>
<li>Class attribute: <code>_known_elements</code> set, shared across all
<code>Molecule</code> objects</li>
</ul>
<div class="sourceCode" id="cb30"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Molecule:</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># This is a CLASS ATTRIBUTE, shared by all instances.</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    _known_elements <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, name, formula, coordinates):</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>        <span class="co"># --- INSTANCE ATTRIBUTES ---</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>        <span class="co"># These belong to the specific object being created (`self`).</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.name <span class="op">=</span> name</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.formula <span class="op">=</span> formula</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.coordinates <span class="op">=</span> np.array(coordinates)</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Update the shared class data based on this instance&#39;s data</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>        elements_in_formula <span class="op">=</span> <span class="st">&#39;&#39;</span>.join(<span class="bu">filter</span>(<span class="bu">str</span>.isalpha, formula))</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> element <span class="kw">in</span> elements_in_formula:</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.<span class="va">__class__</span>._known_elements.add(element)</span></code></pre></div>
<h3 id="instance-methods">2. Instance Methods</h3>
<p>Instance methods work with unique data of each object. All take
<code>self</code> as first argument for access to object attributes.</p>
<div class="sourceCode" id="cb31"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Continuing the Molecule class...</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> calculate_center_of_mass(<span class="va">self</span>):</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Calculates the center of mass for this specific molecule.&quot;&quot;&quot;</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> np.mean(<span class="va">self</span>.coordinates, axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> move(<span class="va">self</span>, vector):</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Moves this specific molecule by a given vector.&quot;&quot;&quot;</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.coordinates <span class="op">+=</span> vector</span></code></pre></div>
<h3 id="class-methods">3. Class Methods</h3>
<p>Class methods work with shared data across all instances. Take
<code>cls</code> as first argument for access to class attributes. Can
also serve as alternative constructors.</p>
<div class="sourceCode" id="cb32"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Continuing the Molecule class...</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="at">@classmethod</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_all_known_elements(cls):</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Returns the set of elements seen across all molecules.&quot;&quot;&quot;</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sorted</span>(<span class="bu">list</span>(cls._known_elements))</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="at">@classmethod</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> from_pdb_file(cls, filename):</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Creates a Molecule instance by reading a PDB file.&quot;&quot;&quot;</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># In a real function, you would parse the file.</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Here, we&#39;ll just use placeholder data.</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Parsing </span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">...&quot;</span>)</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>    parsed_name <span class="op">=</span> <span class="st">&quot;Caffeine&quot;</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>    parsed_formula <span class="op">=</span> <span class="st">&quot;C8H10N4O2&quot;</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>    parsed_coords <span class="op">=</span> np.random.rand(<span class="dv">24</span>, <span class="dv">3</span>) <span class="co"># Placeholder</span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The method calls the standard constructor `cls(...)` to create the object.</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cls(parsed_name, parsed_formula, parsed_coords)</span></code></pre></div>
<h3 id="static-methods">4. Static Methods</h3>
<p>Static methods provide utility functions related to the class but
don’t need access to instance or class data.</p>
<div class="sourceCode" id="cb33"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Continuing the Molecule class...</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="at">@staticmethod</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_atomic_mass(element_symbol):</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;A utility function to get atomic mass.&quot;&quot;&quot;</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    masses <span class="op">=</span> {<span class="st">&#39;H&#39;</span>: <span class="fl">1.008</span>, <span class="st">&#39;C&#39;</span>: <span class="fl">12.011</span>, <span class="st">&#39;O&#39;</span>: <span class="fl">15.999</span>, <span class="st">&#39;N&#39;</span>: <span class="fl">14.007</span>}</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> masses.get(element_symbol, <span class="fl">0.0</span>)</span></code></pre></div>
<p>Usage:</p>
<div class="sourceCode" id="cb34"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Call static method on the class itself</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>mass <span class="op">=</span> Molecule.get_atomic_mass(<span class="st">&#39;C&#39;</span>)  <span class="co"># Returns 12.011</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Can also call on an instance (but not recommended)</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>water <span class="op">=</span> Molecule(<span class="st">&#39;Water&#39;</span>, <span class="st">&#39;H2O&#39;</span>, [[<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>]])</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>mass <span class="op">=</span> water.get_atomic_mass(<span class="st">&#39;H&#39;</span>)  <span class="co"># Returns 1.008</span></span></code></pre></div>
<h3 id="the-complete-class">The Complete Class</h3>
<p>Here is the full, coherent <code>Molecule</code> class we have built.
All the pieces work together.</p>
<div class="sourceCode" id="cb35"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Molecule:</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Class Attribute (shared)</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    _known_elements <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Constructor and Instance Attributes</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, name, formula, coordinates):</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.name <span class="op">=</span> name</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.formula <span class="op">=</span> formula</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.coordinates <span class="op">=</span> np.array(coordinates)</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>        elements_in_formula <span class="op">=</span> <span class="st">&#39;&#39;</span>.join(<span class="bu">filter</span>(<span class="bu">str</span>.isalpha, formula))</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> element <span class="kw">in</span> elements_in_formula:</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.<span class="va">__class__</span>._known_elements.add(element)</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Instance Methods</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> calculate_center_of_mass(<span class="va">self</span>):</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> np.mean(<span class="va">self</span>.coordinates, axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> move(<span class="va">self</span>, vector):</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.coordinates <span class="op">+=</span> vector</span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Class Methods</span></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">@classmethod</span></span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> get_all_known_elements(cls):</span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">sorted</span>(<span class="bu">list</span>(cls._known_elements))</span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">@classmethod</span></span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> from_pdb_file(cls, filename):</span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;Parsing </span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">...&quot;</span>)</span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a>        parsed_name, parsed_formula, parsed_coords <span class="op">=</span> <span class="st">&quot;Caffeine&quot;</span>, <span class="st">&quot;C8H10N4O2&quot;</span>, np.random.rand(<span class="dv">24</span>, <span class="dv">3</span>)</span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> cls(parsed_name, parsed_formula, parsed_coords)</span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Static Method</span></span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">@staticmethod</span></span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> get_atomic_mass(element_symbol):</span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a>        masses <span class="op">=</span> {<span class="st">&#39;H&#39;</span>: <span class="fl">1.008</span>, <span class="st">&#39;C&#39;</span>: <span class="fl">12.011</span>, <span class="st">&#39;O&#39;</span>: <span class="fl">15.999</span>, <span class="st">&#39;N&#39;</span>: <span class="fl">14.007</span>}</span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> masses.get(element_symbol, <span class="fl">0.0</span>)</span></code></pre></div>
<h3 id="summary-instance-vs.-class-vs.-static">Summary: Instance
vs. Class vs. Static</h3>
<p>The key is to distinguish between data that is unique to an instance
versus data that is shared across the entire class.</p>
<table>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr>
<th style="text-align: left;">Method Type</th>
<th style="text-align: left;">Decorator</th>
<th style="text-align: left;">First Argument</th>
<th style="text-align: left;">Operates On…</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><strong>Instance Method</strong></td>
<td style="text-align: left;">(None)</td>
<td style="text-align: left;"><code>self</code></td>
<td style="text-align: left;">Unique instance data (e.g.,
<code>self.coordinates</code>)</td>
</tr>
<tr>
<td style="text-align: left;"><strong>Class Method</strong></td>
<td style="text-align: left;"><code>@classmethod</code></td>
<td style="text-align: left;"><code>cls</code></td>
<td style="text-align: left;">Shared class data (e.g.,
<code>cls._known_elements</code>)</td>
</tr>
<tr>
<td style="text-align: left;"><strong>Static Method</strong></td>
<td style="text-align: left;"><code>@staticmethod</code></td>
<td style="text-align: left;">(None)</td>
<td style="text-align: left;">Only its own inputs</td>
</tr>
</tbody>
</table>
<h2 id="naming-conventions">Naming Conventions</h2>
<p>Python doesn’t strictly enforce naming rules, but strong community
conventions improve readability.</p>
<ul>
<li>Class Names: <code>CamelCase</code> (first letter of each word
capitalized)
<ul>
<li>Examples: <code>Molecule</code>,
<code>SimulationAnalysis</code></li>
</ul></li>
<li>Function and Method Names: <code>snake_case</code> (lowercase with
underscores)
<ul>
<li>Examples: <code>calculate_center_of_mass</code>,
<code>load_data</code></li>
</ul></li>
<li>Variable and Attribute Names: <code>snake_case</code>
<ul>
<li>Examples: <code>self.coordinates</code>,
<code>carbon_mass</code></li>
</ul></li>
</ul>
<p>These conventions make it easy to distinguish classes, functions, and
variables at a glance.</p>
<h2 id="simulating-multiple-constructors-vs.-c">Simulating Multiple
Constructors (vs. C++)</h2>
<p>In C++, you can define multiple constructors with different arguments
(function overloading). Python doesn’t allow this—a second
<code>__init__</code> would overwrite the first.</p>
<p>Python offers two patterns to achieve the same goal.</p>
<h3 id="pattern-1-default-arguments-in-__init__">Pattern 1: Default
Arguments in <code>__init__</code></h3>
<p>Single <code>__init__</code> with optional arguments (default to
<code>None</code>). Use <code>if/elif</code> logic to handle different
cases.</p>
<div class="sourceCode" id="cb36"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Molecule:</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, name, coordinates<span class="op">=</span><span class="va">None</span>, filename<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.name <span class="op">=</span> name</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> coordinates <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.coordinates <span class="op">=</span> np.array(coordinates)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> filename <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>            <span class="co"># In reality, you would parse the file here</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.coordinates <span class="op">=</span> np.random.rand(<span class="dv">10</span>, <span class="dv">3</span>)</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">&quot;Must provide coordinates or a filename.&quot;</span>)</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Usage ---</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>water <span class="op">=</span> Molecule(<span class="st">&#39;Water&#39;</span>, coordinates<span class="op">=</span>[[<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>]])</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>caffeine <span class="op">=</span> Molecule(<span class="st">&#39;Caffeine&#39;</span>, filename<span class="op">=</span><span class="st">&#39;caffeine.pdb&#39;</span>)</span></code></pre></div>
<p>Pros: Simple for few variations<br />
Cons: <code>__init__</code> can become complex and messy</p>
<h3 id="pattern-2-classmethod-factories-recommended">Pattern 2:
<code>@classmethod</code> Factories (Recommended)</h3>
<p>Most powerful and Pythonic. Keep <code>__init__</code> simple and
direct. Create separate, well-named class methods for each alternative
constructor. Same “alternative constructor” pattern discussed
earlier.</p>
<div class="sourceCode" id="cb37"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Molecule:</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The main constructor is simple and direct</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, name, coordinates):</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.name <span class="op">=</span> name</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.coordinates <span class="op">=</span> np.array(coordinates)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># This is an ALTERNATIVE constructor</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">@classmethod</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> from_file(cls, name, filename):</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 1. Perform special logic (e.g., read the file)</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>        coordinates_from_file <span class="op">=</span> np.random.rand(<span class="dv">10</span>, <span class="dv">3</span>) <span class="co"># Placeholder</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 2. Call the main constructor `cls(...)` to create the final object</span></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> cls(name, coordinates_from_file)</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Usage ---</span></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>water <span class="op">=</span> Molecule(<span class="st">&#39;Water&#39;</span>, coordinates<span class="op">=</span>[[<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>]])</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>caffeine <span class="op">=</span> Molecule.from_file(<span class="st">&#39;Caffeine&#39;</span>, filename<span class="op">=</span><span class="st">&#39;caffeine.pdb&#39;</span>)</span></code></pre></div>
<p>Pros: Clean, readable, scalable. <code>Molecule.from_file()</code> is
self-documenting<br />
Cons: Requires slightly more lines of code</p>
<h2 id="advanced-topic-simulating-multiple-dispatch-vs.-julia">Advanced
Topic: Simulating Multiple Dispatch (vs. Julia)</h2>
<p>While C++ uses function overloading, other scientific languages like
Julia use a more powerful concept called <strong>multiple
dispatch</strong>. This allows the system to choose which function to
run based on the runtime types of <em>all</em> of its arguments. This is
extremely useful for implementing different physical models for
different types of interactions.</p>
<p>Python does not have this feature built-in, but you can achieve the
same effect with an external library called
<code>multipledispatch</code>.</p>
<h3 id="the-problem-different-interactions">The Problem: Different
Interactions</h3>
<p>Imagine you have different particle types, and the
<code>interact</code> function should change based on which types it
receives.</p>
<div class="sourceCode" id="cb38"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Atom: <span class="cf">pass</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Ion: <span class="cf">pass</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="co"># interact(Atom(), Atom())   -&gt; should be Lennard-Jones</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="co"># interact(Ion(), Ion())     -&gt; should be Coulomb</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="co"># interact(Atom(), Ion())    -&gt; should be Polarization</span></span></code></pre></div>
<h3 id="the-solution-multipledispatch">The Solution:
<code>multipledispatch</code></h3>
<p>First, install the library:
<code>pip install multipledispatch</code>. Then, you can define your
functions in a clean, declarative way.</p>
<div class="sourceCode" id="cb39"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> multipledispatch <span class="im">import</span> dispatch</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Atom: <span class="cf">pass</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Ion: <span class="cf">pass</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="at">@dispatch</span>(Atom, Atom)</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> interact(p1, p2):</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Calculating Lennard-Jones potential...&quot;</span>)</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="at">@dispatch</span>(Ion, Ion)</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> interact(p1, p2):</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Calculating Coulomb potential...&quot;</span>)</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a><span class="at">@dispatch</span>(Atom, Ion)</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> interact(p1, p2):</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Calculating polarization model...&quot;</span>)</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a><span class="at">@dispatch</span>(Ion, Atom)</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> interact(p1, p2):</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Handle commutative cases by calling the other version</span></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> interact(p2, p1)</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Usage ---</span></span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a><span class="co"># The library dispatches to the correct function based on the types</span></span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>interact(Atom(), Atom())</span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>interact(Ion(), Ion())</span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>interact(Atom(), Ion())</span></code></pre></div>
<p>This pattern is far superior to a messy <code>if/isinstance</code>
chain. It keeps your scientific logic clean, readable, and easily
extensible.</p>
<h2 id="key-takeaways">Key Takeaways</h2>
<ul>
<li>A <strong>Class</strong> is a blueprint for creating objects. An
<strong>Object</strong> is a specific instance created from that
blueprint, bundling its own unique data (attributes) and behaviors
(methods).</li>
<li>The <code>__init__</code> method is the
<strong>constructor</strong>, responsible for setting up an object’s
initial state by assigning values to <code>self</code>.</li>
<li><strong>Instance Methods</strong> use <code>self</code> to operate
on the unique data of a specific object.</li>
<li><strong>Class Methods</strong> use <code>@classmethod</code> and
<code>cls</code> to operate on shared data that belongs to the class
blueprint itself.</li>
<li><strong>Static Methods</strong> use <code>@staticmethod</code> for
utility functions that are related to the class but don’t depend on any
instance or class state.</li>
<li>Python does not have C++-style multiple constructors, but the same
effect is achieved more cleanly using <strong><code>@classmethod</code>
factories</strong>.</li>
</ul>
<p>This syntax provides the complete toolkit for defining the behavior
of your objects, from instance-specific actions to class-level
operations and related utilities.</p>
<hr />
<h2 id="quick-quiz">Quick Quiz</h2>
<p>Test your understanding of the key concepts.</p>
<strong>1. What is the primary difference between a class and an object
(or instance)?</strong>
<details>
<summary>
Answer
</summary>
A <strong>class</strong> is the blueprint or template. It defines the
structure and behavior. An <strong>object</strong> is a specific,
concrete instance created from that blueprint, holding its own unique
data.
</details>
<strong>2. You have a <code>Simulation</code> class. You want to add a
method that calculates the kinetic energy, which depends on the unique
velocities of the particles in that specific simulation. What kind of
method should you write?</strong>
<details>
<summary>
Answer
</summary>
You should write an <strong>instance method</strong>. Its first argument
will be <code>self</code>, allowing it to access
<code>self.velocities</code> to perform the calculation for that
specific simulation instance.
</details>
<strong>3. You want to add a method to your <code>Simulation</code>
class that keeps a running count of how many total simulations have been
created. What kind of method should you use to retrieve this
count?</strong>
<details>
<summary>
Answer
</summary>
You should use a <strong>class method</strong>. You would store the
counter in a <em>class attribute</em> (e.g.,
<code>_simulation_count = 0</code>). The <code>__init__</code> method of
each instance would increment this counter
(<code>self.__class__._simulation_count += 1</code>). The class method
(e.g., <code>get_total_count()</code>) would then access this shared
counter via its <code>cls</code> argument
(<code>return cls._simulation_count</code>).
</details>
<strong>4. You want to add a function to your <code>Simulation</code>
class that converts a temperature from Kelvin to Celsius. This
calculation is logically related to simulations, but does not depend on
any specific simulation’s data or on the class itself. What is the most
appropriate method type?</strong>
<details>
<summary>
Answer
</summary>
A <strong>static method</strong> (using <code>@staticmethod</code>). It
doesn’t need <code>self</code> or <code>cls</code>, making it the
perfect choice for a self-contained utility function that is namespaced
within the class.
</details>
<h1 id="python-classes-inheritance">Python Classes: Inheritance</h1>
<h2 id="building-a-layered-system">Building a Layered System</h2>
<p>Research projects grow complex. Climate models have layered,
interacting components: atmospheric, ocean, sea ice models.
Bioinformatics pipelines chain distinct tools: alignment, variant
calling, annotation.</p>
<p>Flat collections of functions and scripts don’t represent these
layered systems well. Hard to see relationships. Hard to reuse or
replace parts without breaking everything.</p>
<p>Inheritance is the primary tool for managing this complexity. Build a
hierarchy of classes that mirrors your scientific problem’s logical
structure. Define general, abstract concepts at the top (e.g.,
<code>ForceField</code>). Create specific, concrete implementations
below (e.g., <code>LennardJonesForceField</code>,
<code>CoulombForceField</code>).</p>
<p>Two main goals:</p>
<ol type="1">
<li>Build a logical hierarchy: code structure reflects problem
structure</li>
<li>Maximize code reuse: write common logic once in parent class, reuse
in all child classes</li>
</ol>
<h2 id="the-problem-code-duplication">The Problem: Code Duplication</h2>
<p>Imagine you are writing a simulation. You start by creating a class
for an <code>Atom</code>.</p>
<div class="sourceCode" id="cb40"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Atom:</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, mass, position, velocity):</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.mass <span class="op">=</span> mass</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.position <span class="op">=</span> np.array(position)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.velocity <span class="op">=</span> np.array(velocity)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> advance_position(<span class="va">self</span>, dt):</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.position <span class="op">+=</span> <span class="va">self</span>.velocity <span class="op">*</span> dt</span></code></pre></div>
<p>Now, you need to add <code>Ion</code>s to your simulation. An ion is
just like an atom, but it also has a charge. Without inheritance, your
first instinct might be to copy-paste:</p>
<div class="sourceCode" id="cb41"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The copy-paste approach (BAD PRACTICE)</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Ion:</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, mass, position, velocity, charge):</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.mass <span class="op">=</span> mass</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.position <span class="op">=</span> np.array(position)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.velocity <span class="op">=</span> np.array(velocity)</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.charge <span class="op">=</span> charge <span class="co"># The only new line!</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> advance_position(<span class="va">self</span>, dt):</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># This method is identical to the one in Atom!</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.position <span class="op">+=</span> <span class="va">self</span>.velocity <span class="op">*</span> dt</span></code></pre></div>
<p>This is a recipe for disaster. You now have duplicated code. If you
find a bug in <code>advance_position</code>, you have to remember to fix
it in two places. This makes your code harder to maintain and less
reproducible. Inheritance solves this problem by allowing you to define
the common logic once and reuse it.</p>
<h2 id="parent-and-child-classes">Parent and Child Classes</h2>
<p>Inheritance formalizes the relationship between your concepts.</p>
<ul>
<li>Parent class (base class, superclass): contains all common data and
methods
<ul>
<li>Example: <code>Particle</code> class</li>
</ul></li>
<li>Child classes (derived classes, subclasses): inherit all attributes
and methods from parent
<ul>
<li>Can add unique attributes and methods</li>
<li>Can modify inherited ones</li>
</ul></li>
</ul>
<p>Key concept: the “is-a” relationship. An <code>Ion</code> is a
<code>Particle</code>. An <code>Atom</code> is a <code>Particle</code>.
Anything you can do to a <code>Particle</code>, you can do to an
<code>Ion</code>.</p>
<h2 id="syntax-and-examples">Syntax and Examples</h2>
<p>Let’s rebuild our example the right way.</p>
<h3 id="creating-the-parent-class">1. Creating the Parent Class</h3>
<p>First, we define the general <code>Particle</code> class with all the
shared logic.</p>
<div class="sourceCode" id="cb42"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Particle:</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;The parent class for all simulation particles.&quot;&quot;&quot;</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, mass, position, velocity):</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.mass <span class="op">=</span> mass</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.position <span class="op">=</span> np.array(position, dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.velocity <span class="op">=</span> np.array(velocity, dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> advance_position(<span class="va">self</span>, dt):</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Advances the particle&#39;s position based on its velocity.&quot;&quot;&quot;</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.position <span class="op">+=</span> <span class="va">self</span>.velocity <span class="op">*</span> dt</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> calculate_kinetic_energy(<span class="va">self</span>):</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Calculates the kinetic energy.&quot;&quot;&quot;</span></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="va">self</span>.mass <span class="op">*</span> np.dot(<span class="va">self</span>.velocity, <span class="va">self</span>.velocity)</span></code></pre></div>
<h3 id="creating-child-classes">2. Creating Child Classes</h3>
<p>Now, we can create specialized child classes. The syntax is
<code>class ChildClassName(ParentClassName):</code>.</p>
<div class="sourceCode" id="cb43"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Atom(Particle):</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;An Atom is a type of Particle. It inherits everything.&quot;&quot;&quot;</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># We don&#39;t need to write anything here yet!</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># It automatically gets __init__, advance_position, etc. from Particle.</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">pass</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Ion(Particle):</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;An Ion is a Particle that also has a charge.&quot;&quot;&quot;</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, mass, position, velocity, charge):</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># --- Calling the Parent&#39;s Constructor ---</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># It&#39;s crucial to initialize the parent class first.</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># super() refers to the parent class (Particle).</span></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>().<span class="fu">__init__</span>(mass, position, velocity)</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Now, add the new attribute that is unique to the Ion.</span></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.charge <span class="op">=</span> charge</span></code></pre></div>
<p>The <code>super().__init__(...)</code> line is critical. It says,
“run the <code>__init__</code> method of my parent class,” which handles
setting up the <code>mass</code>, <code>position</code>, and
<code>velocity</code>. We then only need to add the one new line to
handle the <code>charge</code>.</p>
<h3 id="using-the-inherited-classes">3. Using the Inherited Classes</h3>
<div class="sourceCode" id="cb44"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an instance of the Atom child class</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>argon_atom <span class="op">=</span> Atom(mass<span class="op">=</span><span class="fl">39.9</span>, position<span class="op">=</span>[<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>], velocity<span class="op">=</span>[<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>])</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an instance of the Ion child class</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>sodium_ion <span class="op">=</span> Ion(mass<span class="op">=</span><span class="fl">22.9</span>, position<span class="op">=</span>[<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>], velocity<span class="op">=</span>[<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>], charge<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="co"># We can call the method defined in the PARENT class on both objects</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>argon_atom.advance_position(<span class="fl">0.1</span>)</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>sodium_ion.advance_position(<span class="fl">0.1</span>)</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Argon atom new position: </span><span class="sc">{</span>argon_atom<span class="sc">.</span>position<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Sodium ion new position: </span><span class="sc">{</span>sodium_ion<span class="sc">.</span>position<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a><span class="co"># The sodium_ion object has the extra attribute</span></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Sodium ion charge: </span><span class="sc">{</span>sodium_ion<span class="sc">.</span>charge<span class="sc">}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<h3 id="overriding-and-extending-methods">4. Overriding and Extending
Methods</h3>
<p>What if we want a child class to behave differently? We can
<strong>override</strong> a parent’s method by simply defining a method
with the same name in the child class.</p>
<p>Let’s add a <code>describe</code> method.</p>
<div class="sourceCode" id="cb45"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Particle:</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ... (previous methods) ...</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> describe(<span class="va">self</span>):</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="ss">f&quot;A particle with mass </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>mass<span class="sc">:.2f}</span><span class="ss">.&quot;</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Ion(Particle):</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ... (__init__ from above) ...</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># This OVERRIDES the parent&#39;s describe method</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> describe(<span class="va">self</span>):</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># But we can still call the parent&#39;s version first using super()</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># This is called EXTENDING the method.</span></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>        parent_description <span class="op">=</span> <span class="bu">super</span>().describe()</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="ss">f&quot;</span><span class="sc">{</span>parent_description<span class="sc">}</span><span class="ss"> And it has a charge of </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>charge<span class="sc">}</span><span class="ss">.&quot;</span></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Comparing the behavior ---</span></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> Particle(<span class="fl">1.0</span>, [<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>], [<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>])</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>ion <span class="op">=</span> Ion(<span class="fl">22.9</span>, [<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>], [<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>], <span class="dv">1</span>)</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(p.describe())</span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(ion.describe())</span></code></pre></div>
<p><strong>Output:</strong></p>
<pre><code>A particle with mass 1.00.
A particle with mass 22.90. And it has a charge of 1.</code></pre>
<p>The <code>Ion</code> class first calls the original
<code>describe</code> method from the <code>Particle</code> class using
<code>super().describe()</code> and then <em>extends</em> it by adding
its own specific information.</p>
<p>By using inheritance, you create a logical and intuitive structure
for your code that eliminates duplication and makes your scientific
models easier to build, maintain, and share.</p>
<p>See the complete code: <code>src/atom.py</code>.</p>
<h2
id="abstract-classes-defining-a-contract-the-python-equivalent-of-c-virtual-classes">Abstract
Classes: Defining a Contract (The Python Equivalent of C++ Virtual
Classes)</h2>
<p>Core idea: create a “contract” or “template” for other classes to
follow. Define a general parent class that should not be used on its
own, but serves as a blueprint guaranteeing all child classes have
consistent structure and specific methods. Cornerstone of building
large, reliable software systems.</p>
<p>C++ does this with “abstract base classes” and “pure virtual
functions.” Python provides the same functionality through the built-in
<code>abc</code> (Abstract Base Class) module.</p>
<h3 id="defining-a-contract">Defining a “Contract”</h3>
<p>Modeling different force fields. Every valid force field must
calculate the energy of a system. We want to enforce this rule in
code.</p>
<p>Create an abstract <code>ForceField</code> class with an “abstract
method” called <code>calculate_energy</code>. This class acts as a
contract. Cannot create an instance of <code>ForceField</code> itself.
Can only create instances of child classes that fulfill the contract by
providing their own concrete implementation of
<code>calculate_energy</code>.</p>
<h3 id="the-syntax-abc-and-abstractmethod">The Syntax: <code>ABC</code>
and <code>@abstractmethod</code></h3>
<div class="sourceCode" id="cb47"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> abc <span class="im">import</span> ABC, abstractmethod</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Inherit from ABC to mark this as an abstract base class.</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> ForceField(ABC):</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="co">    An abstract base class (a contract) for all force fields.</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="co">    It cannot be instantiated directly.</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="co">    &quot;&quot;&quot;</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, parameters):</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.parameters <span class="op">=</span> parameters</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 2. Use the @abstractmethod decorator.</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># This declares that any concrete child class MUST implement this method.</span></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">@abstractmethod</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> calculate_energy(<span class="va">self</span>, positions):</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Calculates the potential energy of the system.&quot;&quot;&quot;</span></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">pass</span></span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Now, we create concrete child classes that fulfill the contract ---</span></span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> LennardJones(ForceField):</span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;A concrete implementation for the Lennard-Jones potential.&quot;&quot;&quot;</span></span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># We MUST implement this method, or Python will raise an error.</span></span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> calculate_energy(<span class="va">self</span>, positions):</span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a>        <span class="co"># In a real scenario, this would be a complex calculation.</span></span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;Calculating energy using the Lennard-Jones potential...&quot;</span>)</span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> np.<span class="bu">sum</span>(positions<span class="op">**</span><span class="dv">2</span>) <span class="co"># Placeholder</span></span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Coulomb(ForceField):</span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;A concrete implementation for the Coulomb potential.&quot;&quot;&quot;</span></span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb47-33"><a href="#cb47-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># We also MUST implement this method.</span></span>
<span id="cb47-34"><a href="#cb47-34" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> calculate_energy(<span class="va">self</span>, positions):</span>
<span id="cb47-35"><a href="#cb47-35" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;Calculating energy using the Coulomb potential...&quot;</span>)</span>
<span id="cb47-36"><a href="#cb47-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> np.<span class="bu">sum</span>(np.<span class="bu">abs</span>(positions)) <span class="co"># Placeholder</span></span></code></pre></div>
<h3 id="enforcing-the-contract">Enforcing the Contract</h3>
<p>The key feature is that Python will prevent you from creating an
object that doesn’t follow the rules.</p>
<div class="sourceCode" id="cb48"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This works perfectly. LennardJones fulfills the contract.</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>lj_potential <span class="op">=</span> LennardJones(parameters<span class="op">=</span>{<span class="st">&#39;sigma&#39;</span>: <span class="fl">1.0</span>, <span class="st">&#39;epsilon&#39;</span>: <span class="fl">0.1</span>})</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>lj_potential.calculate_energy(np.random.rand(<span class="dv">10</span>, <span class="dv">3</span>))</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="co"># This will FAIL with a TypeError!</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="co"># You cannot create an instance of an abstract class.</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>    invalid_ff <span class="op">=</span> ForceField(parameters<span class="op">=</span>{})</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> <span class="pp">TypeError</span> <span class="im">as</span> e:</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss">Error: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<p><strong>Output:</strong></p>
<pre><code>Calculating energy using the Lennard-Jones potential...

Error: Can&#39;t instantiate abstract class ForceField with abstract method calculate_energy</code></pre>
<p>This is the same behavior you would get from a C++ class with a pure
virtual function. The <code>abc</code> module is the “Pythonic” way to
define a mandatory interface for a family of related classes, which is a
cornerstone of robust, large-scale software design.</p>
<h2 id="multi-level-inheritance">Multi-Level Inheritance</h2>
<p>Inheritance is not limited to a single parent-child level. You can
build entire family trees of classes, where a child class becomes a
parent to a grandchild class. This allows you to create highly
specialized classes that inherit and combine features from their entire
ancestry.</p>
<h3 id="a-simple-example-the-animal-kingdom">A Simple Example: The
Animal Kingdom</h3>
<p>Let’s model a simple hierarchy: <code>Animal</code> -&gt;
<code>Mammal</code> -&gt; <code>Dog</code>.</p>
<ol type="1">
<li><p><strong>The Base Class</strong></p>
<p>This class is very general. It has a feature common to all animals:
they have an age.</p>
<div class="sourceCode" id="cb50"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Animal:</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, age):</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.age <span class="op">=</span> age</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> report_age(<span class="va">self</span>):</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="ss">f&quot;I am </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>age<span class="sc">}</span><span class="ss"> years old.&quot;</span></span></code></pre></div></li>
<li><p><strong>The Parent Class (Intermediate Class)</strong></p>
<p>This class inherits from <code>Animal</code>. It adds a feature
common to all mammals: they have fur.</p>
<div class="sourceCode" id="cb51"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Mammal(Animal):</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, age, fur_color):</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Initialize the parent class to set the age</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>().<span class="fu">__init__</span>(age)</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fur_color <span class="op">=</span> fur_color</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> describe_fur(<span class="va">self</span>):</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="ss">f&quot;I have </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>fur_color<span class="sc">}</span><span class="ss"> fur.&quot;</span></span></code></pre></div></li>
<li><p><strong>The Child Class (Concrete Class)</strong> This class
inherits from <code>Mammal</code>. It adds a feature unique to dogs:
they can bark.</p>
<div class="sourceCode" id="cb52"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Dog(Mammal):</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, age, fur_color, breed):</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Initialize the parent class (Mammal)</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>        <span class="co"># The Mammal&#39;s __init__ will in turn initialize the Animal class.</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>().<span class="fu">__init__</span>(age, fur_color)</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.breed <span class="op">=</span> breed</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> bark(<span class="va">self</span>):</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&quot;Woof!&quot;</span></span></code></pre></div></li>
</ol>
<h3 id="using-the-grandchild-class">Using the Grandchild Class</h3>
<p>An instance of the <code>Dog</code> class now has access to the
methods and attributes from its entire inheritance chain:
<code>Dog</code>, <code>Mammal</code>, and <code>Animal</code>.</p>
<div class="sourceCode" id="cb53"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>my_dog <span class="op">=</span> Dog(age<span class="op">=</span><span class="dv">5</span>, fur_color<span class="op">=</span><span class="st">&#39;brown&#39;</span>, breed<span class="op">=</span><span class="st">&#39;Golden Retriever&#39;</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Method from the Dog class</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(my_dog.bark())</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Method from the Mammal class</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(my_dog.describe_fur())</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Method from the Animal class</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(my_dog.report_age())</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Attributes from all levels</span></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Breed: </span><span class="sc">{</span>my_dog<span class="sc">.</span>breed<span class="sc">}</span><span class="ss">, Fur: </span><span class="sc">{</span>my_dog<span class="sc">.</span>fur_color<span class="sc">}</span><span class="ss">, Age: </span><span class="sc">{</span>my_dog<span class="sc">.</span>age<span class="sc">}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<p><strong>Output:</strong></p>
<pre><code>Woof!
I have brown fur.
I am 5 years old.
Breed: Golden Retriever, Fur: brown, Age: 5</code></pre>
<p>This layered approach is extremely powerful for organizing complex
scientific models. You can define general physical laws in a base class,
add more specific behaviors in intermediate classes, and create highly
specialized, concrete classes for your final simulations, all while
maximizing code reuse and maintaining a clear, logical structure.</p>
<h2 id="pythons-inheritance-vs.-c-and-julia">Python’s Inheritance
vs. C++ and Julia</h2>
<p>Coming from other scientific computing languages? Python’s
inheritance is simpler and more flexible—significant advantage for rapid
research and development.</p>
<ul>
<li>Compared to C++: Python’s inheritance is much less verbose
<ul>
<li>No Header Files: define class and methods in single <code>.py</code>
file</li>
<li>No <code>virtual</code> Keyword: all methods are “virtual” by
default. When you call <code>my_object.my_method()</code>, Python runs
the version from the most specific child class. No explicit declaration
needed</li>
<li>Multiple Inheritance: Python supports inheriting from multiple
parents (<code>class C(A, B):</code>). Powerful but complex. C++
supports this too, but Python’s dynamic nature makes it easier to
manage</li>
</ul></li>
<li>Compared to Julia: Julia’s design is fundamentally different
<ul>
<li>Composition over Inheritance: Julia strongly favors “composition”
over inheritance. Instead of <code>Dog</code> being an
<code>Animal</code>, create a <code>Dog</code> struct that has an
<code>Animal</code> struct inside it</li>
<li>No Shared Behavior: cannot inherit methods in Julia (can inherit
types). Primary mechanism for sharing behavior is multiple
dispatch—define functions that operate on different data types</li>
</ul></li>
</ul>
<p>In Julia, this would look like:</p>
<div class="sourceCode" id="cb55"><pre
class="sourceCode julia"><code class="sourceCode julia"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># You can define a type hierarchy</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="kw">abstract type</span> Animal <span class="kw">end</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> Dog <span class="op">&lt;:</span><span class="dt"> Animal  </span><span class="co"># Dog is a subtype of Animal</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>    name<span class="op">::</span><span class="dt">String</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> Cat <span class="op">&lt;:</span><span class="dt"> Animal</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>    name<span class="op">::</span><span class="dt">String</span></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a><span class="co"># methods are defined OUTSIDE the types</span></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">speak</span>(a<span class="op">::</span><span class="dt">Animal</span>)</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">&quot;Some generic animal sound&quot;</span>)</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">speak</span>(d<span class="op">::</span><span class="dt">Dog</span>)</span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">&quot;</span><span class="sc">$</span>(d.name)<span class="st"> says Woof!&quot;</span>)</span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">speak</span>(c<span class="op">::</span><span class="dt">Cat</span>)</span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">&quot;</span><span class="sc">$</span>(c.name)<span class="st"> says Meow!&quot;</span>)</span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code></pre></div>
<p><strong>The Advantage for Scientific Prototyping:</strong></p>
<ul>
<li>Python hits a sweet spot for scientific computing</li>
<li>Inheritance model is powerful enough to build logical hierarchies
needed for complex models</li>
<li>Avoids the rigid, boilerplate-heavy syntax of C++</li>
<li>Faster to prototype, easier to read, and more straightforward to
refactor</li>
<li>Flexibility is crucial as your scientific understanding of the
problem evolves</li>
</ul>
<h2 id="polymorphism-in-scientific-computing">Polymorphism in Scientific
Computing</h2>
<p>All the concepts about inheritance, method overriding, and abstract
classes build towards a powerful design principle: polymorphism. Write
flexible, high-level code that operates on a wide variety of different
objects in a uniform way.</p>
<p>Core idea: single function accepts objects of different classes, as
long as they all “look” the same by adhering to a common interface.</p>
<h3 id="the-problem">The Problem</h3>
<p>Run the same simulation pipeline, but test three different force
field models: <code>LennardJones</code>, <code>Coulomb</code>, and a new
<code>AI_Potential</code>. Without polymorphism, you might write an
<code>if/elif/else</code> block:</p>
<div class="sourceCode" id="cb56"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The NON-polymorphic way (BAD PRACTICE)</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> run_simulation(force_field, positions):</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">isinstance</span>(force_field, LennardJones):</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>        energy <span class="op">=</span> force_field.calculate_energy(positions)</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> <span class="bu">isinstance</span>(force_field, Coulomb):</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>        energy <span class="op">=</span> force_field.calculate_energy(positions)</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ... you have to modify this function every time you add a new model!</span></span></code></pre></div>
<p>This is not scalable and is hard to maintain because:</p>
<ul>
<li><p>You must explicitly check the type with
<code>isinstance()</code></p></li>
<li><p>You must modify this function every time you add a new force
field class!</p></li>
<li><p>The function is tightly coupled to specific class names</p></li>
</ul>
<h3 id="the-polymorphic-solution">The Polymorphic Solution</h3>
<p>By using the <code>ForceField</code> abstract base class we defined
earlier, we create a contract that all force fields must follow. This
allows us to write a single, clean, high-level function that doesn’t
need to know the specific details of the model it’s working with.</p>
<div class="sourceCode" id="cb57"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This is a POLYMORPHIC function.</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="co"># It can accept any object that fulfills the ForceField contract.</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> run_simulation(force_field: ForceField, positions):</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Runs a simulation step using a given force field.&quot;&quot;&quot;</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss">--- Running simulation with </span><span class="sc">{</span>force_field<span class="sc">.</span><span class="va">__class__</span><span class="sc">.</span><span class="va">__name__</span><span class="sc">}</span><span class="ss"> ---&quot;</span>)</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># It doesn&#39;t know the specific type, it just trusts the contract.</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>    energy <span class="op">=</span> force_field.calculate_energy(positions)</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Calculated Energy: </span><span class="sc">{</span>energy<span class="sc">:.2f}</span><span class="ss">&quot;</span>)</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Now we can pass in different types of objects ---</span></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>lj <span class="op">=</span> LennardJones(parameters<span class="op">=</span>{})</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>coulomb <span class="op">=</span> Coulomb(parameters<span class="op">=</span>{})</span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Imagine we wrote a third class, AI_Potential, that also inherits from ForceField</span></span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>run_simulation(lj, np.random.rand(<span class="dv">10</span>,<span class="dv">3</span>))</span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>run_simulation(coulomb, np.random.rand(<span class="dv">10</span>,<span class="dv">3</span>))</span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a><span class="co"># run_simulation(AI_Potential(model_file=&#39;...&#39;), positions)</span></span></code></pre></div>
<p>So polymorphism in Python is more about design philosophy (trusting
interfaces) than syntax. The syntax difference is simply: with or
without <code>isinstance()</code> checks!</p>
<p>This is the ultimate benefit of object-oriented design. Your
high-level scientific workflow is now completely
<strong>decoupled</strong> from the specific models you are using. You
can develop and test new <code>ForceField</code> models without ever
having to change a single line of your main <code>run_simulation</code>
function. This makes your research more flexible, your code more robust,
and your science more reproducible.</p>
<hr />
<h2 id="key-takeaways-1">Key Takeaways</h2>
<ul>
<li><p>Inheritance: primary tool for building logical hierarchy of
classes and maximizing code reuse</p></li>
<li><p>Child class inherits all methods and attributes from parent
class. Use <code>class Child(Parent):</code> to define this
relationship</p></li>
<li><p>Use <code>super().__init__(...)</code> in child’s constructor to
ensure parent class is properly initialized</p></li>
<li><p>Child class can override parent’s method by defining method with
same name. Can extend parent’s method by calling
<code>super().method_name()</code> inside new implementation</p></li>
<li><p>Abstract Base Classes (using <code>ABC</code> and
<code>@abstractmethod</code>) define a “contract” or interface, forcing
child classes to implement specific methods. Python equivalent of C++
pure virtual functions</p></li>
<li><p>Polymorphism: the payoff for using inheritance correctly. Write
clean, high-level functions that operate on any object adhering to a
common interface, making code flexible and extensible</p></li>
</ul>
<hr />
<h2 id="quick-quiz-1">Quick Quiz</h2>
<strong>1. What are the two primary benefits of using
inheritance?</strong>
<details>
<summary>
Answer
</summary>
<ol type="1">
<li><strong>Code Reuse:</strong> It allows you to write common logic
once in a parent class and reuse it in multiple child classes, avoiding
code duplication.</li>
<li><strong>Logical Hierarchy:</strong> It allows you to structure your
code in a way that reflects the natural, hierarchical relationships of
the concepts in your scientific model.</li>
</ol>
</details>
<strong>2. You have a parent class <code>Experiment</code> and a child
class <code>CalorimetryExperiment</code>. Both have an
<code>__init__</code> method. What is the command you must use in the
child’s <code>__init__</code> method to ensure the parent’s
<code>__init__</code> method is also run?</strong>
<details>
<summary>
Answer
</summary>
You must call <code>super().__init__(...)</code>, passing along any
arguments the parent’s constructor needs. This ensures that the setup
logic in the parent class is executed before the child class adds its
own specific attributes.
</details>
<strong>3. You are writing a high-level function that needs to work with
different types of scientific data readers (e.g.,
<code>PDBReader</code>, <code>CSVReader</code>,
<code>HDF5Reader</code>). You want to guarantee that every reader object
has a <code>.read_data()</code> method. What is the best way to enforce
this contract?</strong>
<details>
<summary>
Answer
</summary>
<p>The best way is to create an <strong>abstract base class</strong>
called <code>DataReader</code> that inherits from <code>ABC</code>.
Inside this class, you would define an abstract method: ```python from
abc import ABC, abstractmethod</p>
class DataReader(ABC): <span class="citation"
data-cites="abstractmethod">@abstractmethod</span> def read_data(self):
pass
``<code>You would then make sure that</code>PDBReader<code>,</code>CSVReader<code>, and</code>HDF5Reader<code>all inherit from</code>DataReader<code>and provide their own concrete implementations of the</code>read_data`
method.
</details>
<strong>4. What is polymorphism?</strong>
<details>
<summary>
Answer
</summary>
Polymorphism is the ability to write a single, high-level function that
can operate on objects of different classes. This is possible as long as
those different objects all share a common interface (e.g., they all
inherit from the same base class or have methods with the same names).
It allows you to decouple your main workflow from the specific
implementations of your models, making your code more flexible and
extensible.
</details>
<h1 id="modern-python-classes-dataclasses">Modern Python Classes:
Dataclasses</h1>
<p>This section covers <code>@dataclass</code>: a decorator that can
simplify your class definitions.</p>
<h2 id="the-power-of-dataclass">The Power of
<code>@dataclass</code></h2>
<p>Now that you understand decorators, we can introduce one of the most
useful decorators for scientific programming:
<code>@dataclass</code>.</p>
<p>We have learned how to write a class manually, including the
<code>__init__</code> method to store attributes. This involves a lot of
boilerplate code.</p>
<p><strong>The “Before” Picture: A Manual Class</strong></p>
<div class="sourceCode" id="cb58"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> ManualMolecule:</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, name, charge, num_atoms):</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.name <span class="op">=</span> name</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.charge <span class="op">=</span> charge</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.num_atoms <span class="op">=</span> num_atoms</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__repr__</span>(<span class="va">self</span>):</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>        <span class="co"># We have to write our own representation method for printing.</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="ss">f&quot;ManualMolecule(name=&#39;</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>name<span class="sc">}</span><span class="ss">&#39;, charge=</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>charge<span class="sc">}</span><span class="ss">, num_atoms=</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>num_atoms<span class="sc">}</span><span class="ss">)&quot;</span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__eq__</span>(<span class="va">self</span>, other):</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># We have to write our own equality method for comparing.</span></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(other, ManualMolecule):</span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> (<span class="va">self</span>.name <span class="op">==</span> other.name <span class="kw">and</span></span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.charge <span class="op">==</span> other.charge <span class="kw">and</span></span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.num_atoms <span class="op">==</span> other.num_atoms)</span></code></pre></div>
<p>This is a lot of code just to create a simple data container.</p>
<p><strong>The “After” Picture: Using
<code>@dataclass</code></strong></p>
<p>The <code>@dataclass</code> decorator (from the built-in
<code>dataclasses</code> module) can write all of that boilerplate for
you automatically. All you have to do is declare the attributes using
type hints.</p>
<div class="sourceCode" id="cb59"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> dataclasses <span class="im">import</span> dataclass</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="at">@dataclass</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Molecule:</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Just declare the attributes and their types.</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># That&#39;s it!</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>    name: <span class="bu">str</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>    charge: <span class="bu">int</span></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>    num_atoms: <span class="bu">int</span></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Let&#39;s see what we get for free ---</span></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. A proper __init__ method is automatically generated.</span></span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>water <span class="op">=</span> Molecule(name<span class="op">=</span><span class="st">&#39;Water&#39;</span>, charge<span class="op">=</span><span class="dv">0</span>, num_atoms<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. A beautiful __repr__ method is generated for easy debugging.</span></span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(water)</span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Output: Molecule(name=&#39;Water&#39;, charge=0, num_atoms=3)</span></span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. A proper __eq__ method is generated for value-based comparison.</span></span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a>water2 <span class="op">=</span> Molecule(name<span class="op">=</span><span class="st">&#39;Water&#39;</span>, charge<span class="op">=</span><span class="dv">0</span>, num_atoms<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Are the two molecules equal? </span><span class="sc">{</span>water <span class="op">==</span> water2<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Output: Are the two molecules equal? True</span></span></code></pre></div>
<h3 id="why-dataclass-is-perfect-for-scientific-computing">Why
<code>@dataclass</code> is Perfect for Scientific Computing</h3>
<p>In research, we often work with simple objects whose primary purpose
is to hold data (e.g., simulation result, experimental parameters,
record from a file). <code>@dataclass</code> is the perfect tool for
this:</p>
<ol type="1">
<li>Reduces boilerplate: define clean, readable data object in just a
few lines</li>
<li>Provides useful <code>__repr__</code>: automatic representation
makes data objects easy to inspect and debug</li>
<li>Makes testing easy: automatic <code>__eq__</code> method allows easy
comparison of two data objects to see if they hold same
values—invaluable when writing tests</li>
</ol>
<p>Using <code>@dataclass</code> lets you write clearer, more concise,
and more robust code. Focus on the science instead of writing
boilerplate methods.</p>
<h1
id="python-packaging-turning-your-code-into-an-installable-tool">Python
Packaging: Turning Your Code into an Installable Tool</h1>
<p>So far, we’ve focused on structuring code using classes to make it
robust and reproducible. But how do you share that code with a colleague
or the wider scientific community? Emailing a <code>.py</code> file is a
start, but not a professional or reliable solution. Recipient won’t know
what dependencies are needed, what versions are compatible, and they’ll
have to manage the file manually.</p>
<p>This is where packaging comes in. Goal: bundle your Python code into
a standardized format that can be easily installed, managed, and
distributed. Gold standard: make your tool installable with a simple
command: <code>pip install your-tool-name</code>.</p>
<p>This section walks you through this process in three parts:</p>
<ol type="1">
<li>Part 1: Creating Your First Package. Turn a local script into a
properly structured project you can install and test on your own
machine</li>
<li>Part 2: Sharing Your Package. Two common ways to distribute your
package: via private GitHub repository or public Python Package Index
(PyPI)</li>
<li>Part 3: The Development Cycle. How to release new versions of your
package as you make improvements</li>
</ol>
<h3 id="recall-classes-vs.-modules-in-python">Recall: Classes
vs. Modules in Python</h3>
<p>Classes:</p>
<ul>
<li><p>A class defines a blueprint for creating objects that bundle data
(attributes) and behavior (methods).</p></li>
<li><p>Ideal for representing complex entities or workflows where state
and operations are tightly coupled (e.g., a simulation, a data
processor).</p></li>
<li><p>Supports encapsulation, inheritance, and polymorphism, enabling
more advanced software design.</p></li>
<li><p>Classes are defined within modules and can be reused across
projects.</p></li>
<li><p>Classes bundle related data and methods for more complex
tasks.</p></li>
</ul>
<p>Modules:</p>
<ul>
<li><p>A module is a single Python file, or a collection of files, that
groups related functions, variables, and classes.</p></li>
<li><p>Useful for organizing code by topic, workflow, or functionality
(e.g., <code>math.py</code>, <code>io_utils.py</code>).</p></li>
<li><p>Promotes code reuse and separation of concerns.</p></li>
<li><p>Modules are imported using the <code>import</code> statement,
making code easy to share and maintain.</p></li>
</ul>
<h2 id="part-1-creating-your-first-package-v0.1.0">Part 1: Creating Your
First Package (v0.1.0)</h2>
<p>Our first goal is to take a standalone Python file and turn it into a
real, installable package. We will start by creating version
<code>0.1.0</code>.</p>
<h3 id="step-1.1-a-standard-project-structure">Step 1.1: A Standard
Project Structure</h3>
<p>The Python community has adopted a standard layout for projects that
is recognized by all modern packaging tools. The most important
convention is to place your actual source code inside a dedicated
directory.</p>
<p>Here is the recommended structure:</p>
<pre><code>heat1d-project/
├── src/
│   └── heat1d/
│       ├── __init__.py
│       └── heat1d_class.py
├── tests/
│   └── test_heat1d.py
├── pyproject.toml
└── README.md</code></pre>
<p>Let’s break this down:</p>
<ul>
<li><code>heat1d-project/</code>: The root directory of your
project.</li>
<li><code>src/</code>: A directory that contains your Python source
code. This separation is a modern best practice that prevents many
common packaging problems.</li>
<li><code>src/heat1d/</code>: This is your actual <strong>Python
package</strong>. The name of this directory is what users will use when
they <code>import</code> your code.</li>
<li><code>src/heat1d/__init__.py</code>: This file is often empty. Its
presence tells Python that the <code>heat1d</code> directory is a
package.</li>
<li><code>src/heat1d/heat1d_class.py</code>: Your actual Python code
file.</li>
<li><code>pyproject.toml</code>: This is the most important file. It’s
the modern, standardized file for configuring your project, telling
Python’s build tools everything they need to know to package your
code.</li>
</ul>
<h3 id="step-1.2-the-pyproject.toml-configuration-file">Step 1.2: The
<code>pyproject.toml</code> Configuration File</h3>
<p>This file is the heart of your package. It contains all the metadata
about your project. Using the TOML (Tom’s Obvious, Minimal Language)
format, it is designed to be easy for humans to read and write.</p>
<p>Here is a simple but complete <code>pyproject.toml</code> for our
project:</p>
<div class="sourceCode" id="cb61"><pre
class="sourceCode toml"><code class="sourceCode toml"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pyproject.toml</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="kw">[build-system]</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="dt">requires</span> <span class="op">=</span> <span class="op">[</span><span class="st">&quot;setuptools&gt;=61.0&quot;</span><span class="op">]</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="dt">build-backend</span> <span class="op">=</span> <span class="st">&quot;setuptools.build_meta&quot;</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a><span class="kw">[project]</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a><span class="dt">name</span> <span class="op">=</span> <span class="st">&quot;heat1d-simulation&quot;</span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a><span class="dt">version</span> <span class="op">=</span> <span class="st">&quot;0.1.0&quot;</span></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a><span class="dt">authors</span> <span class="op">=</span> <span class="op">[</span></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>  <span class="op">{ </span><span class="dt">name</span><span class="op">=</span><span class="st">&quot;Your Name&quot;</span><span class="op">, </span><span class="dt">email</span><span class="op">=</span><span class="st">&quot;your.email@example.com&quot;</span><span class="op"> },</span></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a><span class="op">]</span></span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a><span class="dt">description</span> <span class="op">=</span> <span class="st">&quot;A simple 1D heat equation solver.&quot;</span></span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a><span class="dt">readme</span> <span class="op">=</span> <span class="st">&quot;README.md&quot;</span></span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a><span class="dt">requires-python</span> <span class="op">=</span> <span class="st">&quot;&gt;=3.8&quot;</span></span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a><span class="dt">classifiers</span> <span class="op">=</span> <span class="op">[</span></span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Programming Language :: Python :: 3&quot;</span><span class="op">,</span></span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;License :: OSI Approved :: MIT License&quot;</span><span class="op">,</span></span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Operating System :: OS Independent&quot;</span><span class="op">,</span></span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a><span class="op">]</span></span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a><span class="dt">dependencies</span> <span class="op">=</span> <span class="op">[</span></span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;numpy&quot;</span><span class="op">,</span></span>
<span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;matplotlib&quot;</span><span class="op">,</span></span>
<span id="cb61-24"><a href="#cb61-24" aria-hidden="true" tabindex="-1"></a><span class="op">]</span></span>
<span id="cb61-25"><a href="#cb61-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-26"><a href="#cb61-26" aria-hidden="true" tabindex="-1"></a><span class="kw">[project.urls]</span></span>
<span id="cb61-27"><a href="#cb61-27" aria-hidden="true" tabindex="-1"></a><span class="dt">&quot;Homepage&quot;</span> <span class="op">=</span> <span class="st">&quot;https://github.com/your-username/heat1d-project&quot;</span></span>
<span id="cb61-28"><a href="#cb61-28" aria-hidden="true" tabindex="-1"></a><span class="dt">&quot;Bug Tracker&quot;</span> <span class="op">=</span> <span class="st">&quot;https://github.com/your-username/heat1d-project/issues&quot;</span></span></code></pre></div>
<p>Let’s break down the key sections:</p>
<ul>
<li><code>[build-system]</code>: This section is mostly boilerplate. It
tells <code>pip</code> what tools are needed to build your package (in
this case, <code>setuptools</code>). You can usually just copy-paste
this.</li>
<li><code>[project]</code>: This is where you define your project’s
metadata.
<ul>
<li><code>name</code>: The name that will be used on PyPI (the Python
Package Index). This is what people will type when they run
<code>pip install ...</code>.</li>
<li><code>version</code>: The current version of your package. You will
update this number whenever you release a new version.</li>
<li><code>dependencies</code>: This is a critical field. It lists all
the other packages that your code needs to run (like <code>numpy</code>
and <code>matplotlib</code>). When a user installs your package,
<code>pip</code> will automatically find and install these dependencies
for them.</li>
</ul></li>
</ul>
<h3 id="step-1.3-building-your-package">Step 1.3: Building Your
Package</h3>
<p>Once you have your project structure and your
<code>pyproject.toml</code> file, you are ready to build the package.
This process creates the actual files that will be distributed.</p>
<p>First, you need to install the standard Python build tool:</p>
<div class="sourceCode" id="cb62"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install build</span></code></pre></div>
<p>Now, from the root of your project directory
(<code>heat1d-project/</code>), run the build command:</p>
<div class="sourceCode" id="cb63"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> <span class="at">-m</span> build</span></code></pre></div>
<p>This command creates a new directory called <code>dist/</code>.
Inside, you’ll find two important files:</p>
<ul>
<li><code>heat1d_simulation-0.1.0-py3-none-any.whl</code>: wheel file.
Pre-built, binary distribution format that makes installation very fast
for end-user. Preferred format</li>
<li><code>heat1d_simulation-0.1.0.tar.gz</code>: source distribution
(sdist). Compressed archive of your source code. <code>pip</code> can
use this as fallback if there isn’t a compatible wheel file
available</li>
</ul>
<h3 id="step-1.4-installing-and-testing-your-package-locally">Step 1.4:
Installing and Testing Your Package Locally</h3>
<p>Before you share your package with the world, you should test it on
your own machine. You can install the wheel file you just created
directly using <code>pip</code>.</p>
<p>Navigate out of your project directory and install it:</p>
<div class="sourceCode" id="cb64"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> ..</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install heat1d-project/dist/heat1d_simulation-0.1.0-py3-none-any.whl</span></code></pre></div>
<p>To overwrite an existing installation, use</p>
<pre><code>pip install --force-reinstall dist/heat1d_simulation-0.1.0-py3-none-any.whl </code></pre>
<p>Your package is now installed in your Python environment, just like
any other package. You can now open a Python interpreter or a script
from any directory on your system and use it:</p>
<div class="sourceCode" id="cb66"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>python run<span class="op">-</span>heat.py</span></code></pre></div>
<p>At this point, you have a fully working local package. The next step
is to share it with others.</p>
<h2 id="releasing-your-package">Releasing Your Package</h2>
<p>Once your package is built and tested, you need to host the
distribution files (<code>.whl</code> and <code>.tar.gz</code>)
somewhere others can access them. Two common methods:</p>
<h3 id="option-a-distributing-via-github-releases">Option A:
Distributing via GitHub Releases</h3>
<p>For many projects, especially internal tools or research code, full
release to PyPI is unnecessary. Great alternative: use GitHub Releases.
This workflow ties your package versions directly to your source
control—excellent for reproducibility.</p>
<p>Process integrates <code>git</code> with the build process.</p>
<ol type="1">
<li><p>Commit Your Changes: make sure all your code changes for the new
version are committed to your repository</p></li>
<li><p><strong>Tag the Version:</strong> Create a <code>git</code> tag
that matches the version number in your <code>pyproject.toml</code>.
This permanently marks that specific commit as that version. It’s common
to use tags like <code>v0.1.0</code>.</p>
<div class="sourceCode" id="cb67"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a tag for version 0.1.0</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> tag v0.1.0</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Push the tag to GitHub</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> push origin v0.1.0</span></code></pre></div></li>
<li><p><strong>Create a GitHub Release:</strong></p>
<ul>
<li>Go to your repository on GitHub.</li>
<li>Click on the “Releases” link on the right-hand side.</li>
<li>Click “Draft a new release”.</li>
<li>In the “Choose a tag” dropdown, select the tag you just pushed
(e.g., <code>v0.1.0</code>).</li>
<li>Give the release a title (e.g., “Version 0.1.0”) and write a
description of the changes.</li>
<li>In the “Attach binaries” section, drag and drop the
<code>.whl</code> and <code>.tar.gz</code> files you created in the
<code>dist/</code> directory.</li>
<li>Click “Publish release”.</li>
</ul></li>
</ol>
<p>Your package is now available on GitHub.</p>
<h3 id="how-users-install-from-github">How Users Install from
GitHub</h3>
<p>A user can now install your package directly from your GitHub release
using <code>pip</code>. They just need the URL to the wheel file.</p>
<ol type="1">
<li><p>The user goes to your GitHub Releases page.</p></li>
<li><p>They find the release they want (e.g.,
<code>v0.1.0</code>).</p></li>
<li><p>They right-click on the <code>.whl</code> file and copy its
URL.</p></li>
<li><p>They use that URL with <code>pip install</code>:</p>
<div class="sourceCode" id="cb68"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install https://github.com/your-username/heat1d-project/releases/download/v0.1.0/heat1d_simulation-0.1.0-py3-none-any.whl</span></code></pre></div>
<p><code>pip</code> will download the file and install it along with any
dependencies, just as if it were coming from PyPI. This method is a
powerful way to share installable versions of your code without needing
a public package index.</p></li>
</ol>
<h3 id="option-b-distributing-on-the-python-package-index-pypi">Option
B: Distributing on the Python Package Index (PyPI)</h3>
<p>The final step for sharing your work with the entire community is to
upload it to the Python Package Index (PyPI). This is the official
central repository where <code>pip</code> looks for packages.</p>
<ol type="1">
<li><p><strong>Create an Account:</strong> Register for an account on <a
href="https://pypi.org/">pypi.org</a>.</p></li>
<li><p><strong>Install the Upload Tool:</strong></p>
<div class="sourceCode" id="cb69"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install twine</span></code></pre></div></li>
<li><p><strong>Upload Your Distribution Files:</strong></p>
<div class="sourceCode" id="cb70"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="ex">twine</span> upload dist/<span class="pp">*</span></span></code></pre></div>
<p><code>twine</code> will prompt you for your PyPI username and
password.</p></li>
</ol>
<p>Once the upload is complete, your package is live! Anyone in the
world can now install it by simply running:</p>
<div class="sourceCode" id="cb71"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install heat1d-simulation</span></code></pre></div>
<h2 id="part-3-the-development-cycle-releasing-a-new-version">Part 3:
The Development Cycle: Releasing a New Version</h2>
<p>Once your package is released, you will inevitably want to improve
it. The process of releasing an update is a cycle of coding, versioning,
and re-distributing.</p>
<p>Let’s say you want to release version <code>0.2.0</code>.</p>
<ol type="1">
<li><p><strong>Make Your Code Changes:</strong> Add your new features or
fix bugs in the source code.</p></li>
<li><p><strong>Update the Version Number:</strong> This is a critical
step. Open your <code>pyproject.toml</code> file and increment the
<code>version</code> number.</p>
<div class="sourceCode" id="cb72"><pre
class="sourceCode diff"><code class="sourceCode diff"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="st">- version = &quot;0.1.0&quot;</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="va">+ version = &quot;0.2.0&quot;</span></span></code></pre></div>
<p>It’s common to follow a system called <a
href="https://semver.org/">Semantic Versioning</a>
(Major.Minor.Patch).</p></li>
<li><p><strong>Re-run the Build:</strong></p>
<div class="sourceCode" id="cb73"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> <span class="at">-m</span> build</span></code></pre></div>
<p>This will create new
<code>heat1d_simulation-0.2.0-py3-none-any.whl</code> and
<code>heat1d_simulation-0.2.0.tar.gz</code> files in your
<code>dist/</code> directory.</p></li>
<li><p><strong>Distribute the New Files:</strong> Repeat the steps from
Part 2 to share your new version.</p>
<ul>
<li><strong>For GitHub:</strong> Create a new git tag
(<code>v0.2.0</code>), push it, and create a new GitHub Release,
uploading the new distribution files.</li>
<li><strong>For PyPI:</strong> Run <code>twine upload dist/*</code>
again to upload the new version. PyPI will automatically handle the
version update.</li>
</ul></li>
</ol>
<p>This cycle ensures that users can reliably access specific versions
of your code and understand what has changed between releases.</p>
<h2 id="key-takeaways-2">Key Takeaways</h2>
<ul>
<li><strong>Packaging</strong> is the process of turning your Python
code into a standardized, installable format.</li>
<li>The process can be broken down into three stages:
<strong>creating</strong> the package locally, <strong>sharing</strong>
it via a platform like GitHub or PyPI, and <strong>updating</strong> it
by releasing new versions.</li>
<li>A modern Python project should use a <code>src/</code> layout and be
configured with a <code>pyproject.toml</code> file, which defines its
name, version, and dependencies.</li>
<li>Use the <code>build</code> library (<code>python -m build</code>) to
create distribution files (wheels and source distributions).</li>
<li>Always test your package locally with <code>pip</code> before
distributing it.</li>
<li>To release a new version, you must update the <code>version</code>
number in <code>pyproject.toml</code>, re-build, and then re-distribute
the new files.</li>
</ul>
<p>By following these steps, you can transform your scientific scripts
into professional, reusable, and easily shareable software packages.
This is a critical skill for ensuring your computational research is
reproducible and accessible to others.</p>
<h1 id="calling-external-code-from-python-a-scientists-guide">Calling
External Code from Python: A Scientist’s Guide</h1>
<p>As computational scientists, we often stand on the shoulders of
giants. Many powerful simulation engines and numerical libraries are
written in compiled languages like C, Fortran, or modern
high-performance languages like Julia. This tutorial explains the
standard Python tools for interfacing with this external code.</p>
<hr />
<h2 id="part-1-calling-compiled-c-fortran-with-ctypes">Part 1: Calling
Compiled C &amp; Fortran with <code>ctypes</code></h2>
<p>The most common task is calling functions from existing, compiled
shared libraries (<code>.so</code>, <code>.dll</code>,
<code>.dylib</code>). Python’s built-in
<strong><code>ctypes</code></strong> library is the perfect tool for
this. It acts as a direct, low-level bridge to these libraries without
requiring any extra installation or compilation steps for your Python
code.</p>
<h3 id="the-why-when-to-use-ctypes">The “Why”: When to Use
<code>ctypes</code></h3>
<p>Use <code>ctypes</code> when you have a pre-compiled library and you
want to call functions from it directly, especially when you want to
avoid setting up a complex build system.</p>
<h3 id="practical-example-1-calling-c">Practical Example 1: Calling
C</h3>
<p>Let’s start with a simple C function.</p>
<p><strong>1. The C Code (<code>libadd.c</code>)</strong></p>
<div class="sourceCode" id="cb74"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="dt">double</span> add_doubles<span class="op">(</span><span class="dt">double</span> a<span class="op">,</span> <span class="dt">double</span> b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> a <span class="op">+</span> b<span class="op">;</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><strong>2. Compile to a Shared Library</strong></p>
<div class="sourceCode" id="cb75"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gcc</span> <span class="at">-shared</span> <span class="at">-fPIC</span> <span class="at">-o</span> libadd.so libadd.c</span></code></pre></div>
<p><strong>3. The Python <code>ctypes</code> Code</strong> The Python
script must load the library, define the function’s argument and return
types, and then call it.</p>
<div class="sourceCode" id="cb76"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> ctypes</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Load the library</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>lib_path <span class="op">=</span> os.path.join(os.path.dirname(<span class="va">__file__</span>), <span class="st">&#39;libadd.so&#39;</span>)</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>my_c_library <span class="op">=</span> ctypes.CDLL(lib_path)</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Define the function signature</span></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>add_doubles_func <span class="op">=</span> my_c_library.add_doubles</span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>add_doubles_func.argtypes <span class="op">=</span> [ctypes.c_double, ctypes.c_double]</span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>add_doubles_func.restype <span class="op">=</span> ctypes.c_double</span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Call the function</span></span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> add_doubles_func(<span class="fl">10.5</span>, <span class="fl">20.2</span>)</span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Result from C library: </span><span class="sc">{</span>result<span class="sc">}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<h3 id="practical-example-2-calling-fortran">Practical Example 2:
Calling Fortran</h3>
<p>Calling Fortran is similar, but with two key differences:
<strong>name mangling</strong> (the function name is often changed to
lowercase with a trailing underscore) and
<strong>pass-by-reference</strong> (all arguments are passed as
pointers).</p>
<p><strong>1. The Fortran Code (<code>libadd_f.f90</code>)</strong></p>
<div class="sourceCode" id="cb77"><pre
class="sourceCode fortran"><code class="sourceCode fortranfixed"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="kw">subroutine</span> add_doubles_f(a, b, <span class="kw">result</span>)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">real(8)</span>, <span class="dt">intent(in)</span> <span class="dt">::</span> a, b</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">real(8)</span>, <span class="dt">intent(out)</span> <span class="dt">::</span> <span class="kw">result</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">result</span> <span class="kw">=</span> a <span class="kw">+</span> b</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a><span class="kw">end subroutine</span> add_doubles_f</span></code></pre></div>
<p><strong>2. Compile to a Shared Library</strong></p>
<div class="sourceCode" id="cb78"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="ex">gfortran</span> <span class="at">-shared</span> <span class="at">-fPIC</span> <span class="at">-o</span> libadd_f.so libadd_f.f90</span></code></pre></div>
<p><strong>3. The Python <code>ctypes</code> Code</strong></p>
<div class="sourceCode" id="cb79"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> ctypes</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Load the library</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>lib_path <span class="op">=</span> os.path.join(os.path.dirname(<span class="va">__file__</span>), <span class="st">&#39;libadd_f.so&#39;</span>)</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>my_f_library <span class="op">=</span> ctypes.CDLL(lib_path)</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Define the function signature (note the name change and pointer types)</span></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>add_doubles_func <span class="op">=</span> my_f_library.add_doubles_f_</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>add_doubles_func.argtypes <span class="op">=</span> [</span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>    ctypes.POINTER(ctypes.c_double),</span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>    ctypes.POINTER(ctypes.c_double),</span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>    ctypes.POINTER(ctypes.c_double)</span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a>add_doubles_func.restype <span class="op">=</span> <span class="va">None</span></span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Prepare arguments and call by reference</span></span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> ctypes.c_double(<span class="fl">10.5</span>)</span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> ctypes.c_double(<span class="fl">20.2</span>)</span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> ctypes.c_double()</span>
<span id="cb79-21"><a href="#cb79-21" aria-hidden="true" tabindex="-1"></a>add_doubles_func(ctypes.byref(a), ctypes.byref(b), ctypes.byref(result))</span>
<span id="cb79-22"><a href="#cb79-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-23"><a href="#cb79-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Result from Fortran library: </span><span class="sc">{</span>result<span class="sc">.</span>value<span class="sc">}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<hr />
<h2 id="part-2-bridging-high-level-languages">Part 2: Bridging
High-Level Languages</h2>
<p>When interfacing with other modern scientific languages like Julia or
R, <code>ctypes</code> is not the right tool. Instead, we use dedicated
high-level libraries that manage the communication between the two
language runtimes.</p>
<h3 id="calling-julia-from-python-with-pyjulia">Calling Julia from
Python with <code>PyJulia</code></h3>
<p>The <code>julia</code> library (<code>pip install julia</code>)
starts a Julia session in the background and provides a seamless
bridge.</p>
<p><strong>1. The Julia Code (<code>my_analysis.jl</code>)</strong></p>
<div class="sourceCode" id="cb80"><pre
class="sourceCode julia"><code class="sourceCode julia"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">process_data</span>(data, constant)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> data<span class="op">.^</span><span class="fl">2</span> <span class="op">.+</span> constant</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code></pre></div>
<p><strong>2. The Python Code</strong></p>
<div class="sourceCode" id="cb81"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> julia <span class="im">import</span> Main <span class="im">as</span> jl</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a><span class="co"># This starts the Julia VM (can be slow the first time)</span></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>jl.include(<span class="st">&quot;my_analysis.jl&quot;</span>)</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>python_array <span class="op">=</span> np.array([<span class="fl">1.0</span>, <span class="fl">2.0</span>, <span class="fl">3.0</span>])</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a><span class="co"># PyJulia handles the conversion of NumPy arrays automatically</span></span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>result_array <span class="op">=</span> jl.process_data(python_array, <span class="fl">100.0</span>)</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Result from Julia: </span><span class="sc">{</span>result_array<span class="sc">}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<h3 id="calling-r-from-python-with-rpy2">Calling R from Python with
<code>rpy2</code></h3>
<p>Similarly, the <code>rpy2</code> library
(<code>pip install rpy2</code>) embeds an R process in Python, with
excellent support for converting pandas DataFrames.</p>
<div class="sourceCode" id="cb82"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> rpy2.robjects <span class="im">import</span> pandas2ri</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> rpy2.robjects.packages <span class="im">import</span> importr</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>pandas2ri.activate()</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>stats <span class="op">=</span> importr(<span class="st">&#39;stats&#39;</span>)</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>py_df <span class="op">=</span> pd.DataFrame({<span class="st">&#39;x&#39;</span>: [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>], <span class="st">&#39;y&#39;</span>: [<span class="fl">1.1</span>,<span class="fl">1.9</span>,<span class="fl">3.2</span>,<span class="fl">4.3</span>,<span class="fl">5.1</span>]})</span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a><span class="co"># rpy2 converts the pandas DataFrame and calls R&#39;s lm() function</span></span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>linear_model <span class="op">=</span> stats.lm(<span class="st">&quot;y ~ x&quot;</span>, data<span class="op">=</span>py_df)</span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a>coefficients <span class="op">=</span> stats.coef(linear_model)</span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Slope from R linear model: </span><span class="sc">{</span>coefficients[<span class="dv">1</span>]<span class="sc">:.4f}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<hr />
<h2
id="part-3-choosing-the-right-tool---the-interoperability-ecosystem">Part
3: Choosing the Right Tool - The Interoperability Ecosystem</h2>
<p><code>ctypes</code> is just one tool in a rich ecosystem. Here is a
guide to help you choose the right one for your task.</p>
<ul>
<li><strong>To accelerate your Python code:</strong>
<ul>
<li><strong>Numba:</strong> The best choice for speeding up
<code>for</code> loops over NumPy arrays using a JIT compiler.</li>
<li><strong>Cython:</strong> A more powerful tool that compiles a
Python-like language to C. Use it for complex acceleration tasks or for
creating detailed C-level bindings.</li>
</ul></li>
<li><strong>To call existing C/C++/Fortran libraries:</strong>
<ul>
<li><strong><code>ctypes</code> (this tutorial):</strong> The best
choice when you need a quick, simple way to call a few functions from a
pre-compiled library without any extra build steps. It’s built-in and
easy to use.</li>
<li><strong><code>pybind11</code>:</strong> The modern standard for
creating clean, high-quality bindings for C++ libraries. This is the
tool of choice if you are a C++ developer looking to expose your code to
Python.</li>
<li><strong>Cython:</strong> Can also be used to create very powerful,
high-performance bindings, giving you more control than
<code>ctypes</code>.</li>
</ul></li>
<li><strong>To interface with other high-level languages:</strong>
<ul>
<li><strong><code>PyJulia</code>:</strong> The standard for calling
Julia.</li>
<li><strong><code>rpy2</code>:</strong> The standard for calling R.</li>
</ul></li>
</ul>
<p>By understanding this landscape, you can choose the most appropriate
tool for your specific scientific computing challenge.</p>
<h1 id="summary-and-conclusion">Summary and Conclusion</h1>
<h2 id="workshop-overview">Workshop Overview</h2>
<p>Today we covered foundations for sustainable research software:</p>
<ul>
<li>Transitioning from linear scripts to well-structured, reusable
code</li>
<li>Using Python functions and classes to organize scientific logic</li>
<li>Packaging and distributing code for reproducibility</li>
<li>Building software that scales beyond single-use notebooks</li>
</ul>
<h2 id="key-concepts-covered">Key Concepts Covered</h2>
<h3 id="functions-building-blocks-of-reusable-code">Functions: Building
Blocks of Reusable Code</h3>
<ul>
<li>Type hints improve readability and enable static analysis</li>
<li>Function signatures define clear contracts (arguments and return
types)</li>
<li>Exception handling makes code robust and prevents crashes</li>
<li>Default arguments and keyword-only arguments improve flexibility and
clarity</li>
<li>Proper function design follows single responsibility principle</li>
</ul>
<h3 id="classes-organizing-complex-workflows">Classes: Organizing
Complex Workflows</h3>
<ul>
<li>Classes bundle data (attributes) and behavior (methods) into
coherent units</li>
<li>Self keyword connects methods to specific object instances</li>
<li>Instance methods operate on unique object data</li>
<li>Class methods work with shared data across all instances</li>
<li>Static methods provide utility functions without accessing instance
or class state</li>
<li>Inheritance enables code reuse and logical hierarchies</li>
<li>Abstract base classes define contracts that child classes must
fulfill</li>
<li>Polymorphism allows functions to work with any object adhering to a
common interface</li>
</ul>
<h3 id="why-classes-matter-for-science">Why Classes Matter for
Science</h3>
<ul>
<li>Encapsulation protects data integrity</li>
<li>Clear workflows make research reproducible</li>
<li>Safe refactoring enables long-term project evolution</li>
<li>Multiple independent analyses without variable interference</li>
<li>Objects act as snapshots of specific analyses</li>
</ul>
<h3 id="modern-python-features">Modern Python Features</h3>
<ul>
<li>Dataclasses eliminate boilerplate for data-holding classes</li>
<li>Decorators wrap functions to add behavior (timing, logging,
registration)</li>
<li>Type aliases simplify complex type hints</li>
</ul>
<h3 id="packaging-sharing-your-work">Packaging: Sharing Your Work</h3>
<ul>
<li>Standard project structure: <code>src/</code> layout with
<code>pyproject.toml</code></li>
<li>Build tool creates wheel and source distributions</li>
<li>Two distribution methods: GitHub Releases or PyPI</li>
<li>Version control with git tags ties releases to source control</li>
<li>Semantic versioning (Major.Minor.Patch) communicates changes
clearly</li>
</ul>
<h2 id="the-development-cycle">The Development Cycle</h2>
<p>Sustainable research software follows a continuous cycle:</p>
<ol type="1">
<li>Write code using functions and classes</li>
<li>Organize into modules and packages</li>
<li>Test locally before distribution</li>
<li>Version and release through GitHub or PyPI</li>
<li>Update and iterate as science evolves</li>
</ol>
<h2 id="reproducibility-beyond-code-structure">Reproducibility: Beyond
Code Structure</h2>
<p>True reproducibility requires:</p>
<ul>
<li>Well-structured code (functions and classes)</li>
<li>Documented dependencies (requirements.txt, conda environment)</li>
<li>Version control (git for tracking changes)</li>
<li>Reproducible environments (conda, Docker, Apptainer)</li>
<li>Clear installation instructions</li>
</ul>
<h2 id="from-scripts-to-software">From Scripts to Software</h2>
<p>The progression we covered:</p>
<ol type="1">
<li>Linear scripts → Functions (single responsibility)</li>
<li>Functions → Classes (encapsulation and state)</li>
<li>Classes → Modules (organization by topic)</li>
<li>Modules → Packages (distribution and reuse)</li>
<li>Packages → Released versions (reproducible science)</li>
</ol>
<h2 id="why-this-matters">Why This Matters</h2>
<ul>
<li>Scripts work once; software works repeatedly</li>
<li>One-off code cannot be trusted; structured code can be verified</li>
<li>Floating variables break easily; objects maintain integrity</li>
<li>Manual installations fail; packages install reliably</li>
<li>Undocumented dependencies cause “works on my machine” problems</li>
</ul>
<h2 id="even-in-the-llm-era">Even in the LLM Era</h2>
<p>These skills remain essential:</p>
<ul>
<li>You provide the design thinking LLMs need</li>
<li>You validate and maintain generated code</li>
<li>You make architectural decisions</li>
<li>You ensure long-term sustainability</li>
</ul>
<h2 id="bottom-line">Bottom Line</h2>
<p>Sustainable research software requires:</p>
<ul>
<li>Functions over linear scripts</li>
<li>Classes over floating variables</li>
<li>Packages over emailed files</li>
<li>Versions over “latest copy”</li>
<li>Reproducible environments over “works on my machine”</li>
</ul>
<p>Transform your computational research from fragile scripts into
professional, reproducible, shareable software.</p>
<h2 id="next-in-this-series">Next in This Series</h2>
<ul>
<li>Workshop 2 (October 16): Scaling your science with parallel
computing</li>
<li>Workshop 3 (October 30): Accelerating your code with GPUs</li>
</ul>
<hr />
<p>Thank you for attending today’s workshop!</p>
</body>
</html>
